<template>
    <div style="height: 100%;">
        <div class="slds-page-header">
            <div class="slds-page-header__row">
                <div class="slds-page-header__col-title">
                    <div class="slds-media">
                        <div class="slds-media__body">
                            <span>{objectName}</span>
                            <div class="slds-grid slds-media__body">
                                <div class={titleClass}>
                                    <div class="slds-page-header__name-title" onmouseover={onListViewTitleHover}
                                        onmouseout={onListViewTitleHoverOut}>
                                        <span class="slds-page-header__title slds-truncate"
                                            onclick={onListViewDropdownClicked}
                                            title={selectedListView}>{selectedListViewName}
                                        </span>
                                    </div>
                                    <div class="slds-page-header__name-switcher" onmouseover={onListViewTitleHover}
                                        onmouseout={onListViewTitleHoverOut}>
                                        <div class="slds-dropdown-trigger slds-dropdown-trigger_click">
                                            <lightning-button-icon icon-name="utility:down" variant="bare"
                                                onclick={onListViewDropdownClicked}>
                                            </lightning-button-icon>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="slds-page-header__col-actions">
                    <div class="slds-page-header__controls">
                        <div class="slds-page-header__control">
                            <ul class="slds-button-group-list">
                                <template for:each={quickActions} for:item="quickAction">
                                    <li key={quickAction}>
                                        <lightning-button brand="neutral" label={quickAction}
                                            onclick={handleQuickActionClick}></lightning-button>
                                    </li>
                                </template>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            <div class="slds-page-header__row slds-is-relative slds-m-top_xx-small">
                <c-hd_-list-view_-drop-down onlistitemselected={onListViewSelected} list-views={listViews}
                    data-id="listView">
                </c-hd_-list-view_-drop-down>
            </div>
            <div class="slds-page-header__row">
                <div class="slds-page-header__col-meta">
                    <p class="slds-page-header__meta-text">{recordCount} â€¢ Sorted by {sortedBy}</p>
                </div>
                <div class="slds-page-header__col-controls">
                    <div class="slds-page-header__controls">
                        <lightning-input variant="label-hidden" class="slds-page-header__control" type="search"
                            onchange={handleRecordSearch} placeholder={searchPlaceHolder}></lightning-input>
                        <div class="slds-page-header__control">
                            <div class="slds-dropdown-trigger slds-dropdown-trigger_click">
                                <lightning-button-menu alternative-text="Show menu" menu-alignment="right"
                                    variant="border-filled" icon-name="utility:settings">
                                    <lightning-menu-subheader label="LIST VIEW CONTROLS"></lightning-menu-subheader>
                                    <template for:each={menuItems} for:item="item">
                                        <lightning-menu-item data-id={item.value} onclick={onMenuItemSelected}
                                            key={item.value} href={item.itemURL} target="_blank" value={item.value}
                                            label={item.label}>
                                        </lightning-menu-item>
                                    </template>
                                </lightning-button-menu>
                            </div>
                        </div>
                        <div class="slds-page-header__control">
                            <!-- <lightning-button-icon icon-name="utility:refresh" class="refreshRotate"
                                alternative-text="Refresh" onclick={handleRefresh} title="Refresh">
                            </lightning-button-icon> -->
                            <button class="slds-button slds-button_icon slds-button_icon-border" title="Refresh"
                                alternative-text="Refresh" onclick={handleRefresh}>
                                <svg class="slds-button__icon" aria-hidden="true">
                                    <use xlink:href="/_slds/icons/utility-sprite/svg/symbols.svg?cache=9.28.0#refresh">
                                    </use>
                                </svg>
                            </button>
                        </div>
                        <div class="slds-page-header__control">
                            <lightning-button-icon-stateful icon-name="utility:filterList" size="medium"
                                selected={filterButtonState} onclick={onListViewFilterClicked}
                                alternative-text="Show Filter Conditions" data-button-number="01">
                            </lightning-button-icon-stateful>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="slds-is-relative" style="height:87%">
            <lightning-spinner if:true={isLoadingRecords}></lightning-spinner>
            <div style="height:100%;padding-bottom: 1.5rem;">
                <lightning-datatable key-field="Name" sorted-by={sortBy} sorted-direction={sortDirection} data={records}
                    columns={columns} onloadmore={loadMoreData} load-more-offset="0"
                    enable-infinite-loading={enableInfiniteLoading} show-row-number-column onsort={updateColumnSorting}
                    onrowaction={onRowActionPerformed}>
                </lightning-datatable>
            </div>
            <div style="position:absolute;right:0px;top:0px;height:100%">
                <c-hd_-list_-view_-filter_-expression data-id="listViewFilter">
                </c-hd_-list_-view_-filter_-expression>
            </div>
        </div>
    </div>
    <c-hd-modal-popup data-id="modal" title={modalTitle}>
        <c-hd_-sharing_-settings if:true={showSharingSettings} default-visibility={selectedListView.visibility}>
        </c-hd_-sharing_-settings>
        <c-hd_-select_-fields_-to_-display data-id="selectColumns" if:true={showFieldsToDisplay}
            default-options={defaultColumns} list-options={allColumns}>
        </c-hd_-select_-fields_-to_-display>
        <div slot="footer" class="slds-float_right">
            <lightning-button type="cancel" name="Cancel" label="Cancel" onclick={handleCancel}>
            </lightning-button>
            <lightning-button class="slds-m-left_small" disabled={disableSave} type="submit" name="Save" variant="brand"
                label="Save" onclick={handleSubmit}>
            </lightning-button>
        </div>
    </c-hd-modal-popup>
</template>