<template>
    <div class={itemClass}>
        <div class="slds-media">
            <div class="slds-media__figure">
                <lightning-button-icon icon-name={stateIcon} size="small" variant="bare" onclick={toggleState}>
                </lightning-button-icon>
                <div class="slds-icon_container slds-icon-standard-task slds-timeline__icon" title="task">
                    <lightning-icon icon-name='standard:record_update' size="medium">
                    </lightning-icon>
                </div>
            </div>
            <div class="slds-media__body">
                <div class="slds-grid slds-grid_align-spread slds-timeline__trigger">
                    <div class="slds-grid slds-grid_vertical-align-center slds-truncate_container_75 slds-no-space">
                        <h3 class="slds-truncate" title={itemTemplate.action_History_Description}>
                            <a href={itemTemplate.whoId}>
                                <strong>{itemTemplate.who} </strong>
                            </a>{itemTemplate.title}
                        </h3>
                        <span class="slds-p-horizontal_x-small">
                            <lightning-dynamic-icon if:true={itemTemplate.highlightActivity} type="eq">
                            </lightning-dynamic-icon>
                            <lightning-icon if:false={itemTemplate.highlightActivity} icon-name="utility:clock"
                                size="x-small">
                            </lightning-icon>
                        </span> <b>{itemTemplate.daysAgo}</b>
                    </div>
                    <div class="slds-timeline__actions slds-timeline__actions_inline">
                        <p class="slds-timeline__date">
                            <lightning-formatted-date-time value={itemTemplate.when} year="numeric" month="short"
                                day="2-digit" hour="numeric" minute="numeric">
                            </lightning-formatted-date-time>
                        </p>
                        <!-- <lightning-button-icon icon-name='utility:down' size="small">
                        </lightning-button-icon> -->
                    </div>
                </div>
                <article if:true={isExpanded} class="slds-box slds-timeline__item_details slds-theme_shade"
                    aria-hidden="false">
                    <ul class="slds-list_horizontal slds-wrap">
                        <template for:each={itemTemplate.fields} for:item="field">
                            <li key={field.fieldName}
                                class="slds-grid slds-grid_vertical slds-size_1-of-2 slds-p-bottom_x-small">
                                <span class="slds-text-title">
                                    <lightning-formatted-rich-text value={field.fieldName}>
                                    </lightning-formatted-rich-text>
                                </span>
                                <span class="slds-text-body_medium slds-truncate">
                                    <lightning-formatted-rich-text value={field.fieldValue}>
                                    </lightning-formatted-rich-text>
                                </span>
                            </li>
                        </template>
                    </ul>
                </article>
            </div>
        </div>
    </div>
</template>