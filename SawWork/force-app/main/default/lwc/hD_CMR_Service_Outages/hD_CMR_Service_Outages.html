<template>
    <div class="slds-panel slds-m-top_small slds-is-relative">
        <template if:true={isLoading}>
            <lightning-spinner variant="brand" size="medium"></lightning-spinner>
        </template>
        <template if:false={isLoading}>
        <div class="slds-page-header slds-page-header_record-home">
            <div class="slds-page-header__row">
                <div class="slds-page-header__col-title">
                    <div class="slds-media">
                        <div class="slds-media__figure">
                            <lightning-icon icon-name="standard:event" alternative-text="Service Outage"
                                title="Service Outage">
                            </lightning-icon>
                        </div>
                        <div class="slds-media__body">
                            <h1 class="slds-page-header__title slds-truncate slds-align-middle" title="Service Outages">Service Outages</h1>
                            <p class="slds-text-body_small slds-line-height_reset">List of all service outages </p>
                        </div>
                    </div>
                </div>

                <div class="slds-page-header__col-actions">
                    <lightning-button label="New Service Outage" data-id="NewSO"
                        onclick={onNewSO}>
                    </lightning-button>
                </div>
            </div>
        </div>
        <div class="slds-page-header__row slds-page-header__row_gutters">
            <div class="slds-page-header__col-details">

                <template for:each={diffServiceOutages} for:item="timeSO">
                    <lightning-accordion allow-multiple-sections-open active-section-name={activeSections} key={timeSO.soTime}>
                        <lightning-accordion-section class=" slds-border_top slds-border_left slds-border_right slds-border_bottom"
                            label={timeSO.soTime} name={timeSO.soTime} style="--sds-c-accordion-heading-font-size : 1rem">
    
                            <ol>
                                <template iterator:so={timeSO.soTimeValue}>
                                    <li key={so.value.soValue.Id}>
                                        <article>
                                            <lightning-layout multiple-rows class="slds-p-left_small slds-p-top_small">
                                                <lightning-layout-item class="slds-p-top_x-small">
                                                    <lightning-button-icon icon-name={so.value.expandCollapseIcon} onclick={onExpandCollapseClicked} size="medium" variant="bare"
                                                        class="slds-p-left_small slds-p-top_small" data-id={so.value.soValue.Id}>
                                                    </lightning-button-icon>
                                                </lightning-layout-item>
                                                <lightning-layout-item class="slds-p-left_x-small slds-p-top_xx-small">
                                                    <c-hd_-progress_-ring_-percentage value={so.value.progress} variant={so.value.soIcon} styling={so.value.styling} progress={so.value.progress}>
                                                    </c-hd_-progress_-ring_-percentage>
                                                </lightning-layout-item>
                                                <lightning-layout-item alignment-bump="right" class="slds-p-left_x-small slds-p-top_x-small">
                                                    <a class="slds-text-heading_small slds-text-title_bold" href="javascript:void(0)" data-id={so.value.soValue.Id} onclick={gotoRecord}>
                                                        {so.value.soValue.Name}
                                                    </a>
                                                </lightning-layout-item>
                                                <lightning-layout-item size="3">
                                                    <lightning-progress-indicator current-step={so.value.currentStep} type="path" variant="base" >
                                                        <lightning-progress-step label={so.value.startDate} value="1"></lightning-progress-step>
                                                        <lightning-progress-step label={so.value.endDate} value="2"></lightning-progress-step>
                                                        <lightning-progress-step label="Complete" value="3" hidden></lightning-progress-step>
                                                    </lightning-progress-indicator>
                                                </lightning-layout-item>
                                                <lightning-layout-item class="slds-p-left_small">
                                                    <lightning-button-group>
                                                        <lightning-button label="Edit" data-id={so.value.soValue.Id} onclick={onEdit}>
                                                        </lightning-button>
                                                        <lightning-button label="Clone" data-id={so.value.soValue.Id} onclick={onClone}>
                                                        </lightning-button>
                                                    </lightning-button-group>
                                                </lightning-layout-item>
                                            </lightning-layout>
                                            <lightning-layout>
                                                <lightning-layout-item class="slds-p-left_x-large"></lightning-layout-item>
                                                <lightning-layout-item class="slds-p-left_x-large"></lightning-layout-item>
                                                <lightning-layout-item class="slds-p-left_large" alignment-bump="right">
                                                    <div class="slds-text-title">{so.value.soValue.BMCServiceDesk__Description__c}</div>
                                                </lightning-layout-item>
                                                <lightning-layout-item class="slds-text-title">Start Date</lightning-layout-item>
                                                <lightning-layout-item size="1"></lightning-layout-item>
                                                <lightning-layout-item class="slds-text-title slds-p-right_xx-large" size="1">End Date</lightning-layout-item>
                                                <!-- <lightning-layout-item class="slds-text-title slds-p-right_large">End Date</lightning-layout-item> -->
                                                <lightning-layout-item size="1"></lightning-layout-item>
                                            </lightning-layout>
                                            
                                            <div if:true={so.value.accord} class="slds-p-left_xx-large slds-p-top_small">
                                                <lightning-card title="">
                                                        <div class="slds-form slds-m-around_small" role="list">
                                                            <div class="slds-form__row">
                                                                <div class="slds-form__item" role="listitem">
                                                                    <div class="slds-form-element slds-form-element_edit slds-form-element_readonly slds-form-element_stacked slds-hint-parent">
                                                                        <span class="slds-form-element__label">Service Outage Type</span>
                                                                        <div class="slds-form-element__control">{so.value.soValue.Service_Outage_Type__c}</div>
                                                                    </div>
                                                                </div>
                                                                <div class="slds-form__item" role="listitem">
                                                                    <div class="slds-form-element slds-form-element_readonly slds-form-element_stacked slds-hint-parent">
                                                                        <span class="slds-form-element__label">Blackout period</span>
                                                                        <div class="slds-form-element__control">
                                                                            <input type="checkbox" name="options" value={so.value.soValue.BMCServiceDesk__Blackout__c} disabled="" 
                                                                                checked={so.value.soValue.BMCServiceDesk__Blackout__c} style="width: 15px; height: 15px"/>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <div class="slds-form__item" role="listitem">
                                                                    <div class="slds-form-element slds-form-element_edit slds-form-element_readonly slds-form-element_stacked slds-hint-parent">
                                                                        <span class="slds-form-element__label">Inactive</span>
                                                                        <div class="slds-form-element__control">
                                                                            <input type="checkbox" name="options" value={so.value.soValue.BMCServiceDesk__Inactive__c} disabled="" 
                                                                                checked={so.value.soValue.BMCServiceDesk__Inactive__c} style="width: 15px; height: 15px"/>
                                                                            </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                </lightning-card>
                                            </div>
                                        </article>
                                        <div if:false={so.last} class="slds-border_bottom slds-p-top_medium"></div>
                                        <div if:true={so.last} class="slds-p-top_small"></div>
                                    </li>
                                </template>
                            </ol>
                        </lightning-accordion-section>
                    </lightning-accordion>
                </template>

            </div>
        </div>
        </template>
    </div>
    <c-hd_-Quick-Action_-Handler onrefreshso={fireRefreshSO}></c-hd_-Quick-Action_-Handler>
</template>