<!--
  @description       : 
  @author            : apyati
  @group             : 
  @last modified on  : 08-20-2021
  @last modified by  : apyati
  Modifications Log 
  Ver   Date         Author   Modification
  1.0   07-15-2021   apyati   Initial Version
-->
<template>
    <lightning-card>
        <template if:true={showSpinnerParent}>
            <div>
                <lightning-spinner alternative-text="Loading" size="small"></lightning-spinner>
            </div>
        </template>

        <c-l-2q-manage-product-button-group opp-name={oppName} account-name={accountName} opp-id={recordId12}
            acc-id={accountId} enable-save-button={enableSaveButton} oncancel={handleCancel}
            onaddremovecontractsbutton={handleAddContractsButton} onaddproductsbutton={handleAddProductsButton}
            onchangecurrency={handleChangeCurrencyButton} onrefreshbaseline={handleRefreshBaselineButton}
            onresettobaseline={handleResetToBaseline} oncancelcontract={churnCancelContract}
            onquicksave={quickSaveHandler} onsave={saveHandler} enable-actions={enableActions}>
        </c-l-2q-manage-product-button-group>

        <div class="fixedHeightScrollable">
            <div class="slds-notify slds-notify_alert slds-alert_warning" role="alert" if:true = {refreshContractBaselineFlag}>
                <span class="slds-assistive-text">warning</span>
                <span class="slds-icon_container slds-icon-utility-warning slds-var-m-right_x-small" title="Description of icon when needed">
                  <svg class="slds-icon slds-icon_x-small" aria-hidden="true">
                    <use xlink:href="/assets/icons/utility-sprite/svg/symbols.svg#warning"></use>
                  </svg>
                </span>
                <h2>There is more recent baseline data available. Please click Refresh Baseline to retrieve it.</h2>
            </div>
            <div class="x-accordion-heading">
                <lightning-accordion active-section-name="Product" allow-multiple-sections-open>
                    <lightning-accordion-section name="Opportunity" label="Opportunity Details" class="accordionClass">
                        <c-l-2q-opportunity-details record-id12={recordId12} show-spinner={showSpinner}
                            onhidespinner={hideSpinner} onenablesave={enableSaveButtons} has-access={hasAccess}
                            onsetopptype={setOpportunityType} onoppsave={oppSaveHandler}>
                        </c-l-2q-opportunity-details>
                    </lightning-accordion-section>
                    <lightning-accordion-section name="Product" label="Product Details" class="accordionClass">
                        <template if:true={isParentDataLoaded}>
                            <c-l-2q-product-details opp-id={recordId12} opp-record={oppRecord} has-access={hasAccess}
                                onenablesavebutton={enableSaveButtons} onproductsave={productSaveHandler}
                                onhidespinner={hideSpinner} onselectedcontracts={onSelectedContractsHandler}
                                opp-currency={oppCurrency} currency-rates={currencyRates}>
                            </c-l-2q-product-details>
                        </template>
                    </lightning-accordion-section>
                </lightning-accordion>
            </div>
        </div>


        <template if:true={showAddRemoveContracts}>
            <!-- Modal/Popup Box LWC starts here -->
            <div role="dialog" tabindex="-1" aria-labelledby="modal-heading-01" aria-modal="true"
                aria-describedby="modal-content-id-1" class="slds-modal slds-fade-in-open">
                <div class="slds-modal__container modal-width slds-var-p-around_medium">
                    <c-l-2q-add-remove-contracts record-id={accountId} onaddcontracts={handleAddContracts}
                        oncloseaddcontracts={handleCloseAddContracts} selected-products={selectedProducts}
                        onselectcontractproducts={handleSelectedProducts}>
                    </c-l-2q-add-remove-contracts>
                </div>
            </div>
            <div class="slds-backdrop slds-backdrop_open"></div>
        </template>


        <template if:true={showAddProducts}>
            <!-- Modal/Popup Box LWC starts here -->
            <div role="dialog" tabindex="-1" aria-labelledby="modal-heading-01" aria-modal="true"
                aria-describedby="modal-content-id-1" class="slds-modal slds-fade-in-open">
                <div class="slds-modal__container modal-width slds-var-p-around_medium slds-scrollable">
                    <c-l-2q-add-products onaddproducts={handleAddProducts} oncloseaddproducts={handleCloseAddProducts}>
                    </c-l-2q-add-products>
                </div>
            </div>
            <div class="slds-backdrop slds-backdrop_open"></div>
        </template>



        <template if:true={showChangeCurrency}>
            <!-- Modal/Popup Box LWC starts here -->
            <div role="dialog" tabindex="-1" aria-labelledby="modal-heading-01" aria-modal="true"
                aria-describedby="modal-content-id-1" class="slds-modal slds-fade-in-open">
                <div class="slds-modal__container slds-var-p-around_medium">
                    <c-l-2q-change-currency opportunity-id={recordId12} opportunity-currency={oppCurrency}
                        enable-save-button={enableSaveButton} onchangecurrency={handleChangeCurrency}
                        onclosechangecurrency={handleCloseChangeCurrency}>
                    </c-l-2q-change-currency>
                </div>
            </div>
            <div class="slds-backdrop slds-backdrop_open"></div>
        </template>


        <template if:true={showRefreshBaseline}>
            <!-- Modal/Popup Box LWC starts here -->
            <div role="dialog" tabindex="-1" aria-labelledby="modal-heading-01" aria-modal="true"
                aria-describedby="modal-content-id-1" class="slds-modal slds-fade-in-open">
                <div class="slds-modal__container slds-var-p-around_medium">
                    <c-l-2q-refresh-base-line opportunity-id={recordId12} onrefreshbaseline={handleRefreshBaseline}
                        enable-save-button={enableSaveButton} oncloserefreshbaseline={handleCloseRefreshBaseline}>
                    </c-l-2q-refresh-base-line>
                </div>
            </div>
            <div class="slds-backdrop slds-backdrop_open"></div>
        </template>


        <c-l-2q-confirmation-dialogue cancel-label="Cancel" confirm-label="Confirm"
            message="This will reset all forecasted MRR values to match their baselines. Click Confirm to proceed."
            title="Reset to Baseline Confirmation" visible={showConfirmationDialogue}
            onsubmit={resetToBaseLineHandlerOnChild} onclose={hideConfirmationDialogue}>
        </c-l-2q-confirmation-dialogue>


    </lightning-card>



</template>