<template>
    <div class="slds-page-header">
        <div class="slds-page-header__row">
            <div class="slds-page-header__col-title">
                <lightning-layout>
                    <lightning-layout-item>
                        <div class="slds-form-element__control">
                            <div class="slds-checkbox slds-checkbox_stacked">
                                <input type="checkbox" name="options" id="checkbox-201" value="checkbox-201"
                                    onchange={handleApplyListView} />
                                <label class="slds-checkbox__label" for="checkbox-201">
                                    <span class="slds-checkbox_faux"></span>
                                    <span class="slds-form-element__label">Apply</span>
                                </label>
                            </div>
                        </div>
                    </lightning-layout-item>
                    <lightning-layout-item>
                        <lightning-combobox name="progress" label="List View" value='' placeholder="Select List View"
                            options={options} onchange={handleChange} disabled={applyFilter} style="width: 250px;">
                        </lightning-combobox>
                    </lightning-layout-item>

                    <lightning-layout-item width="200px">
                        <div class="slds-p-left_x-small">
                            <c-hd_-multi-select-pick-list data-id="SPONSOR" if:true={options1} options={options1}
                                onvaluechange={handleValueChange} label="SPONSOR">
                            </c-hd_-multi-select-pick-list>
                        </div>
                    </lightning-layout-item>

                    <lightning-layout-item width="200px" class="slds-p-left_x-small">
                        <c-hd_-multi-select-pick-list data-id="LOCATION" if:true={options2} options={options2}
                            onvaluechange={handleValueChange} label="LOCATION">
                        </c-hd_-multi-select-pick-list>
                    </lightning-layout-item>

                    <lightning-layout-item width="200px" class="slds-p-left_x-small">
                        <c-hd_-multi-select-pick-list data-id="STATUS" if:true={options3} options={options3}
                            onvaluechange={handleValueChange} label="STATUS">
                        </c-hd_-multi-select-pick-list>
                    </lightning-layout-item>

                    <lightning-layout-item width="200px" class="slds-p-left_x-small">
                        <c-hd_-multi-select-pick-list data-id="OWNER" if:true={options4} options={options4}
                            onvaluechange={handleValueChange} label="OWNER">
                        </c-hd_-multi-select-pick-list>
                    </lightning-layout-item>

                    <lightning-layout-item width="200px" class="slds-p-left_x-small">
                        <c-hd_-multi-select-pick-list data-id="CATEGORY" if:true={options5} options={options5}
                            onvaluechange={handleValueChange} label="CATEGORY">
                        </c-hd_-multi-select-pick-list>
                    </lightning-layout-item>

                    <lightning-layout-item>
                        <template if:true={show}>
                            <div class="flex">
                                <div>
                                    <lightning-icon class="custom-pointer slds-p-left_small slds-p-top_large"
                                        title="Clear Filters" icon-name="utility:clear" size="small" onclick={clearFilters}>
                                    </lightning-icon>
                                </div>
                            </div>
                        </template>
                    </lightning-layout-item>
                </lightning-layout>
            </div>
            <div class="slds-page-header__col-actions">
                <div class="slds-page-header__controls">
                    <lightning-input type="date" name="" placeholder="Enter date" label="NAVIGATE TO DATE"
                        class="slds-show slds-p-horizontal_x-small" onchange={navigateToDate} style="max-width:170px;"
                        value={defaultDate}></lightning-input>
                    <lightning-button style="padding-top: 21px;" brand="neutral" label="New" onclick={createNewCMR}></lightning-button>
                </div>
            </div>
        </div>
    </div>
    <div style="position:relative;background-color:#FAFAF9;">
        <div style="width:700px;position:absolute; padding-left:10px;padding-top:5px; padding-bottom:5px;">
            <template for:each={categoriesColor} for:item="cat">
                <section key={cat.cat}>
                    <p style={cat.catcolor}></p>
                    <p style="float:left;text-align:bottom;font-size:11px;padding-top:6px">{cat.cat}</p>
                </section>
            </template>
            <p
                style="float:left;width:15px;height:15px;margin:5px;background: rgb(171, 178, 185);border:1px solid">
            </p>
            <p style="float:left;text-align:bottom;font-size:11px;padding-top:6px">Blackout Days</p>
            <p
                style="float:left;width:15px;height:15px;margin:5px;background: #D1F2EB;border:1px solid">
            </p>
            <p style="float:left;text-align:bottom;font-size:11px;padding-top:6px">Enhanced Review Days</p><br />
        </div><br/>
        <div if:true={popoverRecord} class="slds-popover slds-popover_panel slds-hide" 
            style="position:absolute;left:100000px;font-size:12px;background-color:#F5E8FC" data-id="popover">
            <div class="slds-popover__header" style="padding:5px;">
                <header class="slds-media slds-media_center" style="padding-left:8px;">
                    <span class="slds-icon_container slds-icon-standard-account slds-media__figure">
                        <lightning-icon icon-name="standard:case" size="small"></lightning-icon> 
                    </span>
                    <div class="slds-media__body">
                      <h2 class="slds-text-heading_small slds-hyphenate"><strong>{popoverRecord.Name}</strong></h2>
                    </div>
                </header>
            </div>
            <div class="slds-popover__body slds-p-around_small">
                <div class="slds-grid slds-wrap">
                    <div class="slds-p-horizontal_small slds-size_1-of-1 slds-p-vertical_x-small">
                        <dl>
                          <dt><p class="slds-popover_panel__label slds-truncate">Change Summary</p></dt>
                          <dd><p class="slds-line-clamp_large">{popoverRecord.Change_Summary__c}</p></dd>
                        </dl>
                    </div>
                    <div class="slds-p-horizontal_small slds-size_1-of-2 slds-p-bottom_x-small">
                        <dl>
                          <dt><p class="slds-popover_panel__label slds-truncate">Category</p></dt>
                          <dd><p class="slds-truncate">{popoverRecord.BMCServiceDesk__Change_Category__c}</p></dd>
                        </dl>
                    </div>
                    <div class="slds-p-horizontal_small slds-size_1-of-2 slds-p-bottom_x-small">
                        <dl>
                          <dt><p class="slds-popover_panel__label slds-truncate">Priority</p></dt>
                          <dd><p class="slds-truncate">{popoverRecord.Change_Priority__c}</p></dd>
                        </dl>
                    </div>
                    <div class="slds-p-horizontal_small slds-size_1-of-2 slds-p-bottom_x-small">
                        <dl>
                          <dt><p class="slds-popover_panel__label slds-truncate">Initiator</p></dt>
                          <dd><p class="slds-truncate">{popoverRecord.BMCServiceDesk__FKInitiator__r.Name}</p></dd>
                        </dl>
                    </div>
                    <div class="slds-p-horizontal_small slds-size_1-of-2 slds-p-bottom_x-small">
                        <dl>
                          <dt><p class="slds-popover_panel__label slds-truncate">Sponsor</p></dt>
                          <dd><p class="slds-truncate">{popoverRecord.HD_Sponsor_Name__c}</p></dd>
                        </dl>
                    </div>
                    <div class="slds-p-horizontal_small slds-size_1-of-2 slds-p-bottom_x-small">
                        <dl>
                          <dt><p class="slds-popover_panel__label slds-truncate">Service</p></dt>
                          <dd><p class="slds-truncate">{popoverRecord.HD_Service_Impacted__c}</p></dd>
                        </dl>
                    </div>
                    <div class="slds-p-horizontal_small slds-size_1-of-2 slds-p-bottom_x-small">
                        <dl>
                          <dt><p class="slds-popover_panel__label slds-truncate">Sub-Service</p></dt>
                          <dd><p class="slds-truncate">{popoverRecord.HD_Sub_services_Impacted__c}</p></dd>
                        </dl>
                    </div>
                    <div class="slds-p-horizontal_small slds-size_1-of-1 slds-p-bottom_x-small">
                        <dl>
                          <dt><p class="slds-popover_panel__label">Start Date</p></dt>
                          <dd><p class="slds-truncate">{popoverRecord.BMCServiceDesk__Scheduled_Start_Date__c}</p></dd>
                        </dl>
                    </div>
                    <div class="slds-p-horizontal_small slds-size_1-of-1 slds-p-bottom_x-small">
                        <dl>
                          <dt><p class="slds-popover_panel__label">End Date</p></dt>
                          <dd><p class="slds-truncate">{popoverRecord.BMCServiceDesk__Scheduled_End_Date__c}</p></dd>
                        </dl>
                    </div>
                </div>
            </div>
        </div>
        <div>
            <lightning-layout style="height: 100%;overflow: hidden;">
                <lightning-layout-item size={calendarSize}>
                    <div class="slds-scrollable_y  slds-col slds-p-horizontal_small slds-border_right">
                        <div style="padding-top:15px;padding-bottom:10px" align="center">
                            <lightning-spinner if:true={showSpinner} variant="brand" size="medium" data-id="spinner"
                                    alternative-text="Loading"></lightning-spinner>
                            <div data-id="calendar" class="fullcalendarjs"></div>
                        </div>
                    </div>
                </lightning-layout-item>
                <lightning-layout-item size={previewSize} class="slds-p-around-xx_large slds-is-relative slds-scrollable_y" style="height:680px">
                    <c-hd_-c-m-r_-preview if:true={showPreview} record={selectedRecord}>
                    </c-hd_-c-m-r_-preview>
                    <lightning-button-icon style="position:absolute;right:0px;top:0px;" icon-name="utility:close"
                        class="slds-float_right slds-m-top_small slds-m-right_small" onclick={onClosePreview}>
                    </lightning-button-icon>
                </lightning-layout-item>
            </lightning-layout>
        </div>
    </div>
</template>