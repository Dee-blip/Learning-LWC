<template>
    <template if:true={isLoading}>
        <c-lwc-incident-record-page-place-holder type="highlightPanel"></c-lwc-incident-record-page-place-holder>
    </template>
    <template if:false={isLoading}>
        <div class="slds-page-header slds-page-header_record-home">
            <div class="slds-page-header__row">

                <div class="slds-page-header__col-title">
                    <div class="slds-media">
                        <div class="slds-media__figure">
                            <lightning-icon icon-name="standard:case_change_status" alternative-text="Approved"
                                title="Approved">
                            </lightning-icon>
                        </div>
                        <div class="slds-media__body">
                            <div class="slds-page-header__name">
                                <div class="slds-page-header__name-title">
                                    <h1 class="slds-text-title_caps">
                                        <span>Change Managment Request</span>
                                        <span class="slds-page-header__title slds-truncate"
                                            title={incidentNumber}>{changeName}</span>
                                    </h1>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="slds-col slds-size_4-of-12 slds-has-flexi-truncate slds-align_absolute-center">
                    <div if:true={serviceOutageDetailToShow} class={styleClass} role="alert">
                        <span class="slds-assistive-text">info</span>
                        <span class="slds-icon_container slds-icon-utility-user slds-m-right_x-small"
                            title="Description of icon when needed">
                            <lightning-icon 
                                icon-name="utility:info" 
                                size="small" 
                                title={title}>
                            </lightning-icon>
                        </span>
                        <h2>{serviceOutageInfo}</h2>
                    </div>
                </div>
                <div class="slds-col slds-size_4-of-12 slds-no-flex slds-align-top slds-float_right">
                    <c-h-D_-C-M-R_-Quick-Action-Group data-id="actionButtons"
                        listofactionsdisplay={listOfActionsDisplay} change={change} is-loading={isLoading}>
                    </c-h-D_-C-M-R_-Quick-Action-Group>
                </div>
            </div>
            <div class="slds-page-header__row slds-page-header__row_gutters">
                <div class="slds-page-header__col-details">
                    <ul class="slds-page-header__detail-row ">
                        <template for:each={values} for:item="field">
                            <li class="slds-page-header__detail-block" key={field.key}>
                                <div class="slds-text-title_caps slds-truncate slds-m-bottom_xx-small">
                                    {field.label}
                                </div>
                                <template if:true={field.isIcon}>
                                    <div class="slds-media slds-media_center">
                                        <div class="slds-media__figure slds-m-top_xx-small">
                                            <lightning-avatar src="" initials="" fallback-icon-name={field.iconName}
                                                size="x-small" variant="circle"></lightning-avatar>
                                        </div>
                                        <div class="slds-media__body slds-m-top_xx-small">
                                            {field.key}
                                        </div>
                                    </div>
                                </template>
                                <template if:true={field.isText}>
                                    <lightning-layout>
                                        <lightning-layout-item>
                                            <div class={field.class} title={field.toolTip}>
                                                <lightning-formatted-text value={field.key}></lightning-formatted-text>
                                            </div>
                                        </lightning-layout-item>
                                    </lightning-layout>
                                </template>
                            </li>

                        </template>
                        <li class="slds-page-header__detail-block"></li>
                        
                        <template if:true={serviceOutageDetailToShow}>
                        <li class="slds-page-header__detail-block" style="border-left: 1px solid grey;">
                          
                                <lightning-layout>
                                    <lightning-layout-item>
                                        <c-hd_cmr_-Blackout_-Moratorium record-id={recordId}
                                            changestartdate={changeStartDate}
                                            serviceoutageblackout={serviceOutageBlackout}
                                            serviceoutagemoratorium={serviceOutageMoratorium} variant={variant}>
                                        </c-hd_cmr_-Blackout_-Moratorium>
                                    </lightning-layout-item>
                                </lightning-layout>
                            
                        </li>
                        </template>

                       

                        <template iterator:it={serviceOutageDetailToShow} >

                            <li class="slds-page-header__detail-block slds-truncate so-hide"  key={it.value.key}>
                                <div class="slds-text-title_caps  slds-m-bottom_xx-small">
                                    {it.value.key}
                                </div>
                                <div class="slds-media slds-media_center">
                                    <div class="slds-media__body slds-m-top_xx-small">
                                        <template if:false={it.value.isText}>
                                            <lightning-formatted-date-time value={it.value.value}
                                                class="slds-m-top_xxx-small"></lightning-formatted-date-time>
                                        </template>
                                        <template if:true={it.value.isText}>
                                            <lightning-layout>
                                                <lightning-layout-item>
                                                    <div style="width:12rem" class="slds-truncate" >
                                                        <lightning-formatted-text value={it.value.value}></lightning-formatted-text>
                                                    </div>
                                                </lightning-layout-item>
                                            </lightning-layout>
                                        </template>
                                    </div>
                                </div>
                            </li>
                        </template>
                    </ul>
                </div>
            </div>
        </div>
    </template>
    <c-hd-c-m-r-progress-indicator record-id={recordId} approval-list={approvalList}>
    </c-hd-c-m-r-progress-indicator>
</template>