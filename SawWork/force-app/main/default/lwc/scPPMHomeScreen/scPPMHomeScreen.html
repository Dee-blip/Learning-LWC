<template>

    <template if:true={showSpinner}>
        <div class="forceModalSpinner testModal" style="z-index: 99 !important">
            <div class="modal-glass" style="opacity: 0.2;">&nbsp;</div>
            <div class="forceInlineSpinner indicatorContainer" aria-hidden="false" role="alert"
                data-aura-class="forceInlineSpinner">
                <div class="forceDotsSpinner" data-aura-class="forceDotsSpinner">
                    <div class="slds-spinner slds-spinner_brand slds-spinner_medium" role="status">
                        <span class="slds-assistive-text">Loading...</span>
                        <div class="slds-spinner__dot-a"></div>
                        <div class="slds-spinner__dot-b"></div>
                    </div>
                </div>
            </div>
        </div>
    </template>

    <!-- *************************************************** SUMMARY DASHBOARD ******************************************************** -->

    <div>
        <div class="slds-grid">
            <div class="slds-col">
                <div class="slds-card" style="background: lightgrey">
                    <div class="slds-grid slds-gutters summaryDash">
                        <header class="slds-media slds-media_center slds-has-flexi-truncate">

                            <template if:true={displayFilter}>
                                <lightning-button-icon icon-name="utility:chevrondown" variant="bare"
                                    style="padding-right: 6px; padding-left: 14px;" alternative-text="Collapse"
                                    title="Collapse" onclick={hideFilter}>
                                </lightning-button-icon>
                            </template>

                            <template if:false={displayFilter}>
                                <lightning-button-icon icon-name="utility:chevronright" variant="bare"
                                    style="padding-right: 6px; padding-left: 14px;" alternative-text="Collapse"
                                    title="Collapse" onclick={showFilter}>
                                </lightning-button-icon>
                            </template>

                            <div class="slds-media slds-col slds-size_3-of-8"
                                style="padding-left: 0px;align-items: center">
                                <lightning-icon icon-name="utility:alert" alternative-text="Initial Response Pending"
                                    variant="error" title="Initial Response Pending" size="medium"></lightning-icon>
                                <span title="Initial Response Pending" class="summaryDashboard">Red Cases :&nbsp;
                                    <button style="color: #006dcc" value="red"
                                        title="Click to view Cases with pending Initial Response"
                                        onclick={getNavRecords}>
                                        {redCount}
                                    </button>
                                </span>
                            </div>

                            <div class="slds-media slds-col slds-size_3-of-8" style="align-items: center">
                                <lightning-icon icon-name="utility:leave_conference" alternative-text="Unassigned Cases"
                                    variant="inverse" title="Unassigned Cases" size="medium"></lightning-icon>
                                <span class="summaryDashboard" title="Unassigned Cases">White Cases :&nbsp;
                                    <button style="color: #006dcc" value="white"
                                        title="Click to view Unassigned Cases" onclick={getNavRecords}>
                                        {whiteCount}
                                    </button>
                                </span>
                            </div>

                            <div class="slds-media slds-col" style="align-items: center">
                                <lightning-icon icon-name="utility:turn_off_notifications"
                                    alternative-text="Customer Response Received" variant="warning"
                                    title="Customer Response Received" size="medium"></lightning-icon>
                                <span class="summaryDashboard" title="Customer Response Received">Yellow Cases :&nbsp;
                                    <button style="color: #006dcc" value="yellow"
                                        title="Click to view Cases with Customer Response" onclick={getNavRecords}>
                                        {yellowCount}
                                    </button>
                                </span>
                            </div>


                        </header>
                    </div>
                </div>




                <!-- *************************************************** FILTERS ******************************************************** -->
                <template if:true={displayFilter}>
                    <div class="slds-card filterDiv" style="background: #f3f2f2">
                        <div class="slds-grid slds-gutters" style="padding: 2.18vh;">
                            <header class="slds-media slds-media_center slds-has-flexi-truncate">

                                <div class="slds-media slds-col slds-size_2-of-8">
                                    <lightning-checkbox-group name="Severity" label="Severity"
                                        options={severityFilterValues} value={selectedSeverity}
                                        onchange={handleSeverityChange} variant="label-inline" class="caseSevClass"
                                        style="font-weight: 420;"></lightning-checkbox-group>
                                </div>

                                <div class="slds-media slds-col slds-size_2-of-8">
                                    <lightning-combobox name="Geography" label="Geography" options={geoFilterValues}
                                        value={selectedGeography} onchange={handleGeographyChange}
                                        variant="label-inline"></lightning-combobox>
                                </div>


                                <div style="padding-left: 75px; padding-bottom: 8px;">
                                    <lightning-button variant="brand" icon-name="utility:save" label="Save" title="Save"
                                        onclick={applyFilters} class="slds-button slds-m-left_x-small">
                                    </lightning-button>

                                    <lightning-button variant="neutral" label="Reset" title="Reset"
                                        onclick={handleReset} class="slds-button slds-m-left_x-small">
                                    </lightning-button>
                                </div>
                            </header>
                        </div>
                    </div>
                </template>
            </div>
        </div>
    </div>


    <!-- ******************************************* NOTIFICATION CENTER *************************************************** -->
    <div class="sidenav">
        <div class="slds-panel__header">
            <a onclick={closeNav}>
                <lightning-icon icon-name="utility:chevronright" alternative-text="close" title="close" size="x-small">
                </lightning-icon>
            </a><br />
            <h2 class="slds-panel__header-title slds-text-heading_small" style="color:#005fb2; text-align: center">
                <b>{notificationCenterHeader}</b>
            </h2>
        </div>

        <div class="slds-panel__body">
            <template for:each={notificationlist} for:item="eachItem">
                <p class="slds-p-horizontal_small" key={eachItem.akamId}>
                    <button class="slds-button slds-button_outline-brand" value={eachItem.caseRecId}
                        onclick={navigateToCase}>
                        {eachItem.Body}!
                    </button>
                </p>
                <br key={eachItem.akamId} />
            </template>
        </div>
    </div>





    <!-- **************************************************** CASE DASHBOARD *******************************************************-->
    <div class="slds-card" style="height: auto; margin-top: 15px;max-height: 80vh; ">
        <div class="slds-grid slds-gutters headerStyle">

            <!-- *************************** HEADER **********************************************-->
            <header class="slds-media slds-media_center slds-has-flexi-truncate">

                <div>
                    <template if:true={showCaseSpinner}>
                        <div style="opacity: 0.7;" class="slds-spinner_container">
                            <lightning-spinner alternative-text="Loading" variant="brand" size="medium">
                            </lightning-spinner>
                        </div>
                    </template>
                </div>

                <div class="slds-media__figure slds-col slds-size_5-of-7">

                    <ul class="slds-list_horizontal slds-media_center">
                        <li>
                            <template if:true={displayCase}>
                                <lightning-button-icon icon-name="utility:chevrondown" variant="bare"
                                    style="padding-right: 6px; padding-left: 2px;" alternative-text="Collapse"
                                    title="Collapse" onclick={hideCaseTable}>
                                </lightning-button-icon>
                            </template>

                            <template if:false={displayCase}>
                                <lightning-button-icon icon-name="utility:chevronright" variant="bare"
                                    style="padding-right: 6px; padding-left: 2px;" alternative-text="Collapse"
                                    title="Collapse" onclick={showCaseTable}>
                                </lightning-button-icon>
                            </template>
                        </li>

                        <li>
                            <lightning-icon icon-name="standard:case" size="small" alternative-text="Cases"
                                title="Cases">
                            </lightning-icon>
                        </li>

                        <li>
                            <span style="font-size:16px;padding-left: 10px;">{sevSelected} Open Cases
                                ({totalCases})</span>
                        </li>
                    </ul>
                </div>


                <!-- ******************************** SEARCH *******************************************-->
                <div class="slds-col slds-size_1-of-5" style="padding: 0px;">
                    <lightning-input value={caseSearchText} placeholder="Search Cases..." type="text" name="Case Search"
                        class="labelHidden" onchange={delayedSearch}>
                    </lightning-input>
                </div>

                <div class="slds-col" style="padding-left: 0px;">
                    <button class="slds-button" onclick={clearSearchInput}>
                        <lightning-icon icon-name="utility:clear" alternative-text="Clear" size="x-small">
                        </lightning-icon>
                    </button>
                </div>

                <div class="slds-col rightAlign ">
                    <button class="slds-button" onclick={resetPollerAndRefresh}>
                        <lightning-icon icon-name="action:refresh" alternative-text="Refresh Dashboard" size="x-small">
                        </lightning-icon>
                    </button>
                </div>

            </header>
        </div>

        <!-- ****************************** CASES TABLE ************************************ -->

        <div class="datatableStyle" id="dt" data-id="pCase">
            <div id="divForDatatable" class="panelCase" style="height:70vh; transition: 0.25s">
                <lightning-datatable key-field="id" data={caseDataPerPage} columns={columns} wrap-text-max-lines="2"
                    column-widths-mode="auto" hide-checkbox-column>
                </lightning-datatable>
            </div>
        </div>

        <div class="slds-theme--default slds-align_absolute-center">

            <lightning-button variant="brand" label={currentpage}></lightning-button>
        
            <template for:each={paginationRange} for:item="pageNo">
                <lightning-button variant="brand-outline" data-item={pageNo} label={pageNo} key={pageNo}
                onclick={handlePaginationClick}></lightning-button>
            </template>
            </div>

    </div>


</template>