<template>
    <template if:true={showResetConfirmation}>
        <section role="dialog" tabindex="-1" class="slds-modal slds-fade-in-open">
            <div class="slds-modal__container">
                <header class="slds-modal__header">
                    <h2 id="modal-heading-01" class="slds-text-heading_medium slds-hyphenate">Do you want to reset the
                        form?</h2>
                    <lightning-button-icon icon-name="utility:close" alternative-text="Close this window" size="large"
                        variant="bare-inverse" class="slds-modal__close" onclick={hideResetModal}>
                    </lightning-button-icon>
                </header>
                <div class="slds-modal__content slds-var-p-around_medium">
                    <p>{resetText}</p>
                </div>
                <footer class="slds-modal__footer">
                    <lightning-button class="slds-var-p-horizontal_small" name="cancel" label="Cancel" title="Cancel"
                        onclick={hideResetModal}></lightning-button>
                    <lightning-button class="slds-var-p-horizontal_small" variant="destructive" name="reset"
                        label="Reset" title="Reset" onclick={handleFormReset}></lightning-button>
                </footer>
            </div>
        </section>
        <div class="slds-backdrop slds-backdrop_open"></div>
    </template>
    <div class={formDivClasses}>
        <lightning-spinner if:true={showSpinner} alternative-text="Processing form..." size="large" variant="brand">
        </lightning-spinner>
        <lightning-record-edit-form class="slds-theme_default" object-api-name="SecLaw_Transition_Form__c"
            record-id={formId} onload={handleFormLoad} onchange={handleFormChange} onsubmit={handleFormSubmit}
            onsuccess={handleFormSuccess} onerror={handleFormError}>
            <div if:true={showFormCannotBeEditedError}>
                <p>This form has been submitted.</p>
            </div>
            <div if:true={showForm} class="seclaw-form-heading-top">
                <b><u>General Information for Transition to SecLaw</u></b>
            </div>
            <div if:true={showForm} class="seclaw-form-field">
                <label for="gen_info">Select the one of the following options that applies:</label>
                <lightning-input-field id="gen_info" field-name="General_Information__c" variant="label-hidden"
                    data-field="gen_info" onchange={handleConfigChange}>
                </lightning-input-field>
            </div>
            <template if:true={showHighPrioritySection}>
                <div if:true={showForm} class="seclaw-form-field">
                    <label for="actions_summary"><abbr title="required" class="slds-required">*</abbr>Provide a summary
                        of the actions taken:</label>
                    <lightning-input-field id="actions_summary" field-name="Steps_taken_so_far__c"
                        variant="label-hidden" data-field-label="Summary" data-field-type="rich" data-required="true"
                        required onchange={handleFieldChange}>
                    </lightning-input-field>
                </div>
            </template>
            <template if:true={showCPClaimQuestionnaireSection}>
                <div if:true={showForm} class="seclaw-form-heading">
                    <b><u>CP Claim Questionnaire</u></b>
                </div>
                <div if:true={showForm} class="seclaw-form-field">
                    <label for="on_akamai">Is this content on Akamai?</label>
                    <lightning-input-field id="on_akamai" field-name="Content_on_Akamai__c" variant="label-hidden"
                        data-field="content_on_akamai" onchange={handleConfigChange}>
                    </lightning-input-field>
                </div>
                <template if:true={showCPCodeSection}>
                    <div if:true={showForm} class="seclaw-form-field">
                        <label for="cp_code"><abbr title="required" class="slds-required">*</abbr>Please provide a CP
                            code:</label>
                        <lightning-input-field id="cp_code" field-name="CP_Code__c" variant="label-hidden"
                            data-field-label="CP Code" data-required="true" required onchange={handleFieldChange}>
                        </lightning-input-field>
                    </div>
                    <div if:true={showForm} class="seclaw-form-field">
                        <label for="blocked_removed">Has the content been blocked/removed already by AkaTec?</label>
                        <lightning-input-field id="blocked_removed" field-name="Content_Blocked_Removed__c"
                            variant="label-hidden" onchange={handleConfigChange}>
                        </lightning-input-field>
                    </div>
                    <div if:true={showForm} class="seclaw-form-field">
                        <label for="customer_informed_of_blocking">Has the customer been informed of the
                            content/blocking?</label>
                        <lightning-input-field id="customer_informed_of_blocking"
                            field-name="Customer_informed_of_content_blocking__c" variant="label-hidden">
                        </lightning-input-field>
                    </div>
                    <div if:true={showForm} class="seclaw-form-field">
                        <label for="requestor_informed_of_case_handling">Has the requestor been informed that the case
                            is being handled?</label>
                        <lightning-input-field id="requestor_informed_of_case_handling"
                            field-name="Requestor_informed_of_case_handling__c" variant="label-hidden">
                        </lightning-input-field>
                    </div>
                </template>
            </template>
            <template if:true={showOtherSection1}>
                <div if:true={showForm} class="seclaw-form-heading">
                    <b><u>Other</u></b>
                </div>
                <div if:true={showForm} class="seclaw-form-field">
                    <label for="akamai_related">Is this Akamai-related?</label>
                    <lightning-input-field id="akamai_related" field-name="Akamai_related__c" variant="label-hidden"
                        data-field="akamai_related" onchange={handleConfigChange}>
                    </lightning-input-field>
                </div>
                <template if:true={showOtherSection2}>
                    <div if:true={showForm} class="seclaw-form-field">
                        <label for="urls_ip_addresses"><abbr title="required" class="slds-required">*</abbr>Provide
                            Akamai-specific URL(s)/IP address(es) and the connected CP code(s)</label>
                        <lightning-input-field id="urls_ip_addresses" field-name="URLs_IPs_and_connected_CP_code__c"
                            variant="label-hidden" data-required="true" required onchange={handleFieldChange}>
                        </lightning-input-field>
                    </div>
                    <div if:true={showForm} class="seclaw-form-field">
                        <label for="connected_account">Connected Account Name</label>
                        <lightning-input-field id="connected_account" field-name="Connected_Account__c"
                            variant="label-hidden">
                        </lightning-input-field>
                    </div>
                </template>
            </template>
            <template if:true={showAdditionalDetailsSection}>
                <div if:true={showForm} class="seclaw-form-heading">
                    <b><u>Additional Details</u></b> (You will be able to attach files to this form after it has been
                    saved or submitted)
                </div>
                <div if:true={showForm} class="seclaw-form-field">
                    <label for="request_type"><abbr title="required" class="slds-required">*</abbr>Select the Request
                        Type</label>
                    <lightning-input-field id="request_type" field-name="Request_Type__c" variant="label-hidden"
                        data-field="request_type" data-required="true" required onchange={handleConfigChange}>
                    </lightning-input-field>
                </div>
                <div if:true={showForm} class="seclaw-form-field">
                    <label for="reported_issue"><abbr title="required" class="slds-required">*</abbr>What is the
                        reported issue?</label>
                    <lightning-input-field id="reported_issue" field-name="reported_issue__c" variant="label-hidden"
                        data-required="true" required onchange={handleFieldChange}>
                    </lightning-input-field>
                </div>
                <div if:true={showForm} class="seclaw-form-field">
                    <label for="steps_taken">What steps have been taken so far to investigate the request? How is this
                        connected to Akamai? Please provide the outcome (your notes, collected data, links to external
                        sites such as VirusTotal, screenshots).</label>
                    <lightning-input-field id="steps_taken" field-name="Steps_taken_so_far__c" variant="label-hidden">
                    </lightning-input-field>
                </div>
                <div if:true={showForm} class="seclaw-form-field">
                    <label for="complainant_informed">Has the complainant been informed about case creation?</label>
                    <lightning-input-field id="complainant_informed" field-name="Complainant_is_informed__c"
                        variant="label-hidden">
                    </lightning-input-field>
                </div>
                <div if:true={showForm} class="seclaw-form-field">
                    <label for="whats_required"><abbr title="required" class="slds-required">*</abbr>What is required
                        from SecLaw? Add a “brief summary”. Include an explanation of what is required from the SecLaw
                        Team.</label>
                    <lightning-input-field id="whats_required" field-name="What_is_required_from_SecLaw__c"
                        variant="label-hidden" data-required="true" required onchange={handleFieldChange}>
                    </lightning-input-field>
                </div>
                <div if:true={showForm} class="seclaw-form-field">
                    <label for="enough_info">Is there enough information to perform analysis for this type of request?
                        (based on the data provided by the requestor and your own research).</label>
                    <lightning-input-field id="enough_info" field-name="Enough_information__c" variant="label-hidden"
                        data-field="enough_info" onchange={handleConfigChange}>
                    </lightning-input-field>
                </div>
                <template if:true={showInformationForAnalysisSection}>
                    <label if:true={showForm}>If yes, please fill in the following:</label>
                    <div if:true={showForm} class="seclaw-form-field">
                        <label for="timeframe"><abbr title="required" class="slds-required">*</abbr>The exact timeframe
                            the occurrence was observed - preferably with sub-second precision:</label>
                        <lightning-input-field id="timeframe" field-name="Timeframe__c" variant="label-hidden"
                            data-field-label="Timeframe" data-required="true" required onchange={handleFieldChange}>
                        </lightning-input-field>
                    </div>
                    <div if:true={showForm} class="seclaw-form-field">
                        <label for="in_depth_description">An in-depth description of the occurrence:</label>
                        <lightning-input-field id="in_depth_description" field-name="In_depth_description__c"
                            variant="label-hidden">
                        </lightning-input-field>
                    </div>
                    <div if:true={showForm} class="seclaw-form-field">
                        <label for="volumetric_data">{volumetricDataFieldLabel}</label>
                        <lightning-input-field id="volumetric_data"
                            field-name="Volumetric_data_traffic_snippets_logs__c" variant="label-hidden"
                            oninput={handleFieldChange} onchange={handleFieldChange}>
                        </lightning-input-field>
                    </div>
                    <template if:true={showAbuseDetailsSection}>
                        <div if:true={showForm} class="seclaw-form-field">
                            <label for="abuse_details">The type of the
                                alleged attack (for example - TCP SYN, UDP etc.) and whether it was directed at a
                                particular destination port or a random port:</label>
                            <lightning-input-field id="abuse_details" field-name="Abuse_claim_attack_details__c"
                                variant="label-hidden">
                            </lightning-input-field>
                        </div>
                    </template>
                </template>
            </template>
            <template if:true={showError}>
                <div class="slds-notify_container slds-is-relative form-error-container">
                    <div role="alert" class="slds-notify slds-notify_toast slds-theme_error form-error">
                        <h2 if:false={showAdditionalInfoRequestTemplate} class="slds-text-heading_small">{errorText}
                        </h2>
                        <h2 if:true={showAdditionalInfoRequestTemplate} class="slds-text-heading_small">
                            <p class="paragraph-break">Please investigate this further. You can go back to the requestor
                                for more information (feel free to use the template below). Please save this form, and
                                complete it later after you collect the necessary details.</p>
                            <p class="paragraph-break">Template:</p>
                            <p class="paragraph-break">“Dear {requestorName},</p>
                            <p class="paragraph-break">This is regarding the case {akamCaseId}.</p>
                            <template if:true={showInfoRequestTemplate1}>
                                <p class="paragraph-break">In order to conduct a full analysis of the claim we require the
                                    following:</p>
                                <p class="pre-wrap">        • An in-depth description of the occurrence,</p>
                                <p class="pre-wrap">        • The exact timeframe the occurrence was observed - preferably with sub-second precision,</p>
                                <p class="pre-wrap">        • Full URL paths (if any),</p>
                                <p class="pre-wrap">        • Source/destination/related IP addresses and ports,</p>
                                <p class="pre-wrap paragraph-break">        • Volumetric data, traffic snippets or logs.</p>
                            </template>
                            <template if:true={showInfoRequestTemplate2}>
                                <p class="paragraph-break">In order to conduct a full analysis of the claim we require the
                                    following:</p>
                                <p class="pre-wrap">        • An in-depth description of the occurrence,</p>
                                <p class="pre-wrap">        • Full URL paths and related IP addresses (if not provided already),</p>
                                <p class="pre-wrap paragraph-break">        • Screenshots and forwarded email communication.</p>
                            </template>
                            <template if:true={showInfoRequestTemplate3}>
                                <p class="paragraph-break">In order to conduct a full analysis of the claim we require
                                    additional information, such as:</p>
                                <p class="pre-wrap">        • An in-depth description of the occurrence,</p>
                                <p class="pre-wrap">        • The exact timeframe the occurrence was observed - preferably with sub-second precision,</p>
                                <p class="pre-wrap">        • Full URL paths (if any),</p>
                                <p class="pre-wrap">        • Source/destination/related IP addresses and ports,</p>
                                <p class="pre-wrap">        • Volumetric data, traffic snippets or logs,</p>
                                <p class="pre-wrap paragraph-break">        • Screenshots and forwarded email communication.</p>
                            </template>
                            <p class="paragraph-break">In case of any questions, feel free to get in touch.</p>
                            <p>Regards,</p>
                            <p>{signature}”</p>
                        </h2>
                    </div>
                </div>
            </template>
            <lightning-messages class="slds-is-relative"></lightning-messages>
            <div if:true={showForm} class="slds-var-m-top_medium">
                <span class="slds-float_right">
                    <lightning-button class="slds-var-m-right_small" variant="destructive-text" label="Reset form"
                        onclick={showResetModal}></lightning-button>
                    <lightning-button variant="brand" type="submit" data-type="submit" label="Submit"
                        onclick={handleSubmitButton}></lightning-button>
                </span>
                <lightning-button type="submit" data-type="save" label="Save for later" onclick={handleSubmitButton}>
                </lightning-button>
            </div>
        </lightning-record-edit-form>
    </div>
    <div if:true={showBottomDiv} class="bottom-div"></div>
</template>