<aura:component controller="SF1_NewOpportunityMobileController">

  <!-- checkfield to show more or less opportunity details of withcontract BL tile -->
  <aura:attribute name="toggle" type="Boolean" default="false"/>
  <!-- differentiator for oppty tiles for with & without contract BL -->
  <aura:attribute name="opptyType" type="String" default="WithoutContractBL"/>
  <!-- opportunity data to be displayed -->
  <aura:attribute name="oppty" type="Opportunity"/>
  <!-- show modal content accordingly -->
  <aura:attribute name="openModalOnClick" type="Boolean" default="false"/>
  <!-- show the particular contracts -->
  <aura:attribute name="contractsToShow" type="List"/>
  <!-- checkfield to show message when fetching contracts through opptyId fails -->
  <aura:attribute name="contractFetchFailed" type="Boolean" default="false"/>

  <!-- util event for navigation -->
  <aura:registerEvent name="Open Contracts" type="c:SF1_NewOpportunityMobileUtilEvent"/>
  <!-- util event for Modal -->
  <aura:registerEvent name="Open Modal" type="c:SF1_NewOpportunityMobileModalEvent"/>

  <!-- oppty tile for WithoutContractBL -->
  <aura:if isTrue="{!v.opptyType == 'WithoutContractBL'}">

    <article class="slds-tile slds-tile_board" onclick="{! c.displayOppty }">
      <lightning:tile >
        <aura:set attribute="media">
          <lightning:icon iconName="standard:opportunity" size="medium" alternativeText="Opportunity..."/>
          <!-- <lightning:input type="checkbox-button" label=" " name="input2" checked="{! v.selectContract }"/> -->
        </aura:set>
        <ul >
          <li class="slds-item slds-has-flexi-truncate">
            <strong><ui:outputText value="{!v.oppty.Name}"/></strong>
          </li>
        </ul>
      </lightning:tile>
      <lightning:tile >
        <ul >
          <aura:if isTrue="{!v.oppty.StageName != null }">
            <li class="slds-item slds-has-flexi-truncate">
              <div class="slds-grid slds-wrap slds-grid_pull-padded">
                <div class="slds-p-horizontal_small slds-size_2-of-6">Stage</div>
                <div class="slds-p-horizontal_small slds-size_4-of-6">{!v.oppty.StageName}</div>
              </div>
            </li>
          </aura:if>

          <aura:if isTrue="{!v.oppty.MRR__c != null }">
            <li class="slds-item slds-has-flexi-truncate">
              <div class="slds-grid slds-wrap slds-grid_pull-padded">
                <div class="slds-p-horizontal_small slds-size_2-of-6">MRR</div>
                <div class="slds-p-horizontal_small slds-size_4-of-6">{!v.oppty.CurrencyIsoCode}&nbsp;<ui:outputNumber value="{!v.oppty.MRR__c}" format="0.00"/></div>
              </div>
            </li>
          </aura:if>

          <aura:if isTrue="{!v.oppty.CloseDate != null }">
            <li class="slds-item slds-has-flexi-truncate">
              <div class="slds-grid slds-wrap slds-grid_pull-padded">
                <div class="slds-p-horizontal_small slds-size_2-of-6">Close Date</div>
                <div class="slds-p-horizontal_small slds-size_4-of-6"><ui:outputDate value="{!v.oppty.CloseDate}"/></div>
              </div>
            </li>
          </aura:if>
        </ul>
      </lightning:tile>

    </article>

  </aura:if>

  <aura:if isTrue="{!v.opptyType == 'WithContractBL'}">
    <!-- oppty tile for WithContractBL -->
    <article class="slds-tile slds-tile_board">
      <div onclick="{! c.displayOppty }">
        <lightning:tile >
          <aura:set attribute="media">
            <lightning:icon iconName="standard:opportunity" size="medium" alternativeText="Opportunity..."/>
            <!-- <lightning:input type="checkbox-button" label=" " name="input2" checked="{! v.selectContract }"/> -->
          </aura:set>
          <ul >
            <li class="slds-item slds-has-flexi-truncate">
              <strong><ui:outputText value="{!v.oppty.Name}"/></strong>
            </li>
          </ul>
        </lightning:tile>
      </div>
      <lightning:tile >
        <ul >
          <div onclick="{! c.displayOppty }">
            <aura:if isTrue="{!v.oppty.StageName != null }">
              <li class="slds-item slds-has-flexi-truncate">
                <div class="slds-grid slds-wrap slds-grid_pull-padded">
                  <div class="slds-p-horizontal_small slds-size_2-of-6">Stage</div>
                  <div class="slds-p-horizontal_small slds-size_4-of-6">{!v.oppty.StageName}</div>
                </div>
              </li>
            </aura:if>

            <aura:if isTrue="{!v.oppty.MRR__c != null }">
              <li class="slds-item slds-has-flexi-truncate">
                <div class="slds-grid slds-wrap slds-grid_pull-padded">
                  <div class="slds-p-horizontal_small slds-size_2-of-6">MRR</div>
                  <div class="slds-p-horizontal_small slds-size_4-of-6">{!v.oppty.CurrencyIsoCode}&nbsp;<ui:outputNumber value="{!v.oppty.MRR__c}" format="0.00"/></div>
                </div>
              </li>
            </aura:if>

            <aura:if isTrue="{!v.oppty.CloseDate != null }">
              <li class="slds-item slds-has-flexi-truncate">
                <div class="slds-grid slds-wrap slds-grid_pull-padded">
                  <div class="slds-p-horizontal_small slds-size_2-of-6">Close Date</div>
                  <div class="slds-p-horizontal_small slds-size_4-of-6"><ui:outputDate value="{!v.oppty.CloseDate}"/></div>
                </div>
              </li>
            </aura:if>

          </div>

          <li class="slds-item slds-has-flexi-truncate">
            <div class="slds-grid slds-border_top">
              <a>
                <div name="{! v.oppty.Id }" onclick="{!c.fireModalEvent}">View Contracts</div>
              </a>
            </div>
          </li>

        </ul>
      </lightning:tile>

    </article>

  </aura:if>

</aura:component>