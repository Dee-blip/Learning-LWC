<!--
  @description       : override New Account Plan Action
  @author            : apyati
  @group             : L2Q
  @last modified on  : 08-23-2021
  @last modified by  : apyati
  Modifications Log 
  Ver   Date         Author                         Modification
  1.0   06-25-2021   apyati                        Initial Version
-->
<aura:component controller="AccountPlanController"
    implements="lightning:actionOverride,flexipage:availableForRecordHome,force:hasRecordId,lightning:isUrlAddressable"
    access="global">

    <lightning:navigation aura:id="navService" />
    <aura:attribute name="recordId" type="string" description="The record id of the request" />
    <aura:attribute name="fields" type="string[]" default= "['Name','Account__c','Archived__c','Plan_Status__c']"/>
    <aura:attribute name="planRecord" type="Account_Plan__c" description="The record  of the request" />
    <aura:attribute name="source" type="string" description="The source  of the request" />

    <lightning:overlayLibrary aura:id="overlayLib" />

    <aura:handler name="init" value="{!this}" action="{!c.doInit}"/>
    <!--<aura:handler event="aura:locationChange" action="{!c.handleDestroy}"/>-->
    <aura:handler name="change" value="{!v.pageReference}" action="{!c.onPageReferenceChanged}" />

    <force:recordData aura:id="recordLoader"
    recordId="{!v.recordId}"
    fields="Name,Account__c"
    targetFields="{!v.planRecord}"
    />

    <aura:html tag="style">
        .slds-modal__container{
        max-width: 100% !important;
        width:60% !important;
        transform: none !important;
        }
        .cuf-content {
        padding: 0 0rem !important;
        }
        .slds-p-around--medium {
        padding: 0rem !important;
        }
        .slds-modal__content{
        overflow-y:hidden !important;
        height:unset !important;
        max-height:480px !important;
        }

    </aura:html>

    <div aura:id="editDialog" role="dialog" tabindex="-1" aria-labelledby="header43"
        class="slds-modal slds-fade-in-open">

        <aura:if isTrue="{!v.showSpinner }">
            <div aura:id="spinnerId" class="slds-spinner_container">
                <div class="slds-spinner--brand  slds-spinner slds-spinner--large slds-is-relative" role="alert">
                    <span class="slds-assistive-text">Loading</span>
                    <div class="slds-spinner__dot-a"></div>
                    <div class="slds-spinner__dot-b"></div>
                </div>
            </div>
        </aura:if>

        <div class="slds-modal__container ">
          
            <div class="slds-modal__header">
                <h2 class="slds-text-heading--medium"> Edit Account Plan</h2>
            </div>

            

            <div class="slds-modal__content slds-var-p-around_medium">
                <lightning:card>
                    <lightning:recordForm aura:id="myRecordForm" recordId="{!v.recordId}"
                        objectApiName="Account_Plan__c" fields="{!v.fields}"  columns="2" mode="edit"
                        onsubmit="{!c.handleSubmit}" onsuccess="{!c.handleSuccess}" oncancel="{!c.handleCancel}"/>
                        
                </lightning:card>
            </div>
        </div>
    </div>

</aura:component>