<aura:component implements="force:appHostable,flexipage:availableForAllPageTypes,force:hasRecordId" access="global" 
                controller="MARIT_CreateOrLinkToLiveChatController">
    <aura:handler name="init" value="{!this}" action="{!c.doInit}"/>
    
    <aura:attribute name="searchText" type="String" default=""/>
    <aura:attribute name="recordIds" type="Object[]"/>
    <aura:attribute name="isFindorLinkButtonVisible" type="Boolean" default="true" />
    <aura:attribute name="islistPopulated" type="Boolean" default="false" />
    <aura:attribute name="isPersonLinked" type="Boolean" default="false" />
    <aura:attribute name="isCreatePersonClicked" type="Boolean" default="false" />
    <aura:attribute name="recordIndex" type="Integer" default="-1"/>
    <aura:attribute name="selectedIndexId" type="String" default = ""/>
    <aura:attribute name="personRecordName" type="String" default="null"/>
    <aura:method name="hideCreateLeadSection" action="{!c.hideLeadSection}">
        <aura:attribute name="mlLeadId" type="String"/>
        <aura:attribute name="personLeadName" type="String"/>
    </aura:method>
    <aura:method name="CancelMarketoLead" action="{!c.cancelMarketoLeadCreation}"></aura:method>
    
    
    <!--<aura:attribute type="list" name="recordIds" />-->
    
    
    <div class="slds-grid slds-wrap">
        <div class="slds-col slds-size--1-of-1">
            <div class="slds-page-header" style="background-color:white;">
                <div class="slds-media">
                    <div class="slds-media__figure">
                        <lightning:icon iconName="custom:custom15" size="small" alternativeText="custom15" />
                    </div>
                    <div class="slds-media__body">
                        <h1 class="slds-page-header__title slds-text-heading_small slds-align-middle slds-truncate" title="Link Person to the Chat">Link Person to the Chat</h1>
                        <br/>
                        
                    </div>
                </div>
                <aura:if isTrue="{!v.isFindorLinkButtonVisible}">
                    <button class="slds-button slds-button_outline-brand"
                                      onclick="{!c.FindOrCreatePerson}">Find or Create a Person</button>
                </aura:if> 
                <aura:if isTrue="{!v.islistPopulated}">
                    <div  class="slds-form-element slds-lookup" data-select="single">
                        <div class="slds-form-element__control">
                            <div class="slds-input-has-icon slds-input-has-icon--right">
                                <lightning:buttonIcon iconName="utility:search" variant="bare" onclick="{! c.handleClick }" alternativeText="Search" class="slds-input__icon" />
                                <ui:inputText value="{!v.searchText}" class="slds-lookup__search-input slds-input" placeholder="Search" />
                            </div>
                        </div>
                    </div>
                    
                    <aura:if isTrue="{!not(empty(v.recordIds))}">
                        <div style="margin-top: 5%;" class="slds-text-title">List of person records</div>
                        <ul class="slds-border_top slds-border_right slds-border_bottom slds-border_left" role="listbox">
                            <aura:iteration items="{!v.recordIds}" var="item" indexVar="ind">
                                <li aura:id="listItemsId" aria-selected="false" onclick="{!c.ListItemClicked}" data-index="{!ind}" class="slds-p-around_xx-small slds-text-align_center" draggable="false" id="0" role="option"  tabindex="0">
                                  {!item.Name} - {!item.Type}
                                </li>
                            </aura:iteration>
                        </ul>
                        <div>
                            <lightning:button aura:id="linkpersonbuttonId" class="slds-m-top_small"
                                             disabled="true" onclick="{!c.linkpersontolivechat}"  label="Link a Person" />
                    	</div>
                    </aura:if>
                    
                    <lightning:button class="slds-m-top_small"
                                      onclick="{!c.backfromList}" variant="brand" label="Back" />
                    
                    <lightning:button class="slds-m-top_small"
                                      onclick="{!c.CreatePerson}" label="Create a Person" />
                </aura:if> 
                
                <aura:if isTrue="{!v.isPersonLinked}">
                    <c:MARIT_LinkedPersonDisplayForm personrecordId = "{!v.selectedIndexId}" personName = "{!v.personRecordName}"></c:MARIT_LinkedPersonDisplayForm>
                    <lightning:button class="slds-m-top_small"
                                      onclick="{!c.backTosearch}" variant="brand" label="Back To Search" />
                </aura:if>
                 <aura:if isTrue="{!v.isCreatePersonClicked}">
                    <c:MARIT_LiveChatMarketoLeadCreation livechatId = "{!v.recordId}" parent="{! this }"></c:MARIT_LiveChatMarketoLeadCreation >
                </aura:if>
                
            </div>
        </div>
    </div>
</aura:component>