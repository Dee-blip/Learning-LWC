<aura:component controller="GSM_Controller_DSRMoveAll" implements="force:lightningQuickAction,force:hasRecordId" access="global">
  
<aura:attribute name="showSearch" type="boolean" default="true"/>
<aura:attribute name="searchKeyword" type="String"/>
<aura:attribute name="opportunityList" type="Opportunity[]"/>
<aura:attribute name="existingOpportunityId" type="String"/>
<aura:attribute name="selectedOpportunity" type="Opportunity"/>
<aura:attribute name="opportunityListisEmpty" type="boolean" default="false"/>

<aura:attribute name="displayMessage" type="String" default=""/>
<aura:attribute name="messageSeverity" type="String"/>
<aura:attribute name="messageTitle" type="String"/>
<aura:attribute name="dsrCount" type="String"/>

          
            
 <!-- Initialization event -->
 <aura:handler name="init" value="{!this}" action="{!c.doInit}"/>

  <!-- Spinning loading wheel -->
 <c:SF1_CustomLoader positionFromTopInPercent="20%"/>

 <!-- Message section to display Errors and Notifications -->
      <aura:if isTrue="{!v.displayMessage != '' ? true : false}">

        <ui:message title="{!v.messageTitle}" severity="{!v.messageSeverity}" closable="false">
          {!v.displayMessage}
          <aura:if isTrue="{!v.selectedOpportunity != null ? true : false}">
          <b><ui:outputURL value="{!'/'+v.selectedOpportunity.Id}" label="{!v.selectedOpportunity.Name}" /></b>
          </aura:if>
        </ui:message>     
         <aura:if isTrue="{!v.existingOpportunityId != null ? true : false}">
          
          &nbsp;&nbsp;<ui:outputURL value="{!'/'+v.existingOpportunityId}" label="Back to Opportunity" />
        </aura:if>

 <!-- End Message Section -->
 <!-- Main body of component  -->
    <aura:set attribute="else">

        
      <div class="slds-float_left" style="padding-top:1%; padding-left:1%;;padding-bottom:1%;">

 <!-- Search section  -->   
 <ui:message title="Move All" severity="info" closable="false">
          You are re-parenting {!v.dsrCount} DSR(s) under current Opportunity
          </ui:message>      

              <br/>
              <div style="padding-left:2%;">
              <table>
                <tr>
                  <td>
                      <ui:inputText aura:id="searchId" class="slds-input" value="{!v.searchKeyword}" required="true" placeholder="Search Opportunity..." keyup="{!c.searchOpportunitiesKey}"/></td>
                    <td >
                  
                      <lightning:button  variant="brand" label="Go" title="Go" onclick="{!c.searchOpportunities}" />
           
                  </td>
              </tr>
          </table>
                <br/>
               </div>
                

<!-- End Search section  -->  
  <!-- Show opportunities  section  -->  

         <ul class="slds-has-dividers_around-space " style="margin-top:2.5%;margin-left:2%; margin-bottom:25%">
          <aura:if isTrue="{!v.opportunityListisEmpty}">
            Your search resulted in 0 results
          </aura:if>

        <aura:iteration items="{!v.opportunityList}" var="opp">
          <li class="slds-item slds-color__background_gray-2">
            <article class="slds-tile slds-tile_board">
              <lightning:tile >

                <ul >
                  <li class="slds-item  slds-has-flexi-truncate">
                    <div class="slds-grid slds-wrap slds-grid_pull-padded">

                      <div class="slds-p-horizontal_small slds-size_1-of-8">
                        <div class="slds-col_bump-left slds-text-align_right">
                          <lightning:icon iconName="standard:opportunity" size="small" alternativeText="Primary Opportunity"/>
                        </div>
                      </div>
                      <div class="slds-p-horizontal_small slds-size_5-of-8 slds-has-flexi-truncate">
                        <strong><ui:outputText value="{! opp.Name }"/></strong>
                      </div>
                      <div class="slds-p-horizontal_small slds-size_2-of-8">
                        <div class="slds-col_bump-left slds-text-align_right">
                          <ui:inputRadio  name="{!opp}" change="{!c.onRadio}" />

                        </div>
                      </div>
                    </div>
                  </li>
                </ul>
              </lightning:tile>
            </article>
          </li>
      </aura:iteration>
    </ul>

<!-- End Show opportunities  section  -->
        </div>

<!-- Footer to show Proceed button  -->
            
<div class="slds-docked-form-footer">

  <aura:if isTrue="{!v.selectedOpportunity != null ? true : false}">
       <span style="padding:1%;">
                <b>{!v.selectedOpportunity.Name}</b>
          &nbsp;    &nbsp;            <lightning:button  variant="brand" label="Proceed" title="Proceed" onclick="{! c.moveAllDSRs }"/>
            </span>
               </aura:if>


</div>
<!-- End Footer to show Proceed button  -->
      </aura:set>
      </aura:if>     
</aura:component>