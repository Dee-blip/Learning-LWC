<!--
Developer          	: Vandhana Krishnamurthy
Description     	: AMG Homescreen Dashboard for Lightning
________________________________________________________________________________________________________

Date                Developer             JIRA #                      		Description                                                       
________________________________________________________________________________________________________
25 Nov 2019     	Vandhana      		 ESESP-1900     		AMG Homescreen Lightning Development
________________________________________________________________________________________________________
-->

<aura:component implements="lightning:hasPageReference,lightning:isUrlAddressable,flexipage:availableForAllPageTypes,flexipage:availableForRecordHome,force:hasRecordId" controller="SC_AMG_Home_Lightning" access="global" extends="c:AuraUtils">
    
    <aura:handler name="init" value="{!this}" action="{!c.init}"/>    
    <lightning:navigation aura:id="navService"/>
    <lightning:workspaceAPI aura:id="workspace"/>
    <aura:attribute name="columns" type="List" default="[]"/>
    
    <aura:handler event="c:SC_AMG_PassFilterValue_Event"  action="{!c.getValue}"/>
    
    <aura:attribute name="data" type="List" access= "global" default="[]"/>
    <aura:attribute name="dataFiltered" type="List" access= "global" default="[]"/>
    <aura:attribute name="slaCasesCount" type="Integer" access= "global" default="0"/>
    
    <aura:attribute name="loadSpinner" type="Boolean" default = "true"/>
    
    <aura:attribute name="sortedBy" type="String" default="sla"/>
    <aura:attribute name="sortedDirection" type="String" default="asc"/>
	
        <div class="slds-card">
            <div class="slds-card__header slds-grid slds-gutters">
                <header class="slds-media slds-media_center slds-has-flexi-truncate">
                    
                    <div>
                        <aura:if isTrue="{!v.loadSpinner}">
                            <lightning:spinner alternativeText="Loading" variant="brand" size="large"/>
                        </aura:if>
                    </div>
                    
                    <div class="slds-col slds-size_2-of-5">
                        
                        <ul class="slds-list_horizontal slds-media_center">
                            <li>
                                <lightning:icon iconName="action:priority" class="slds-icon" size="small"/>
                            </li>
                            <li class="">
                                <span style="font-size:17px;padding-left: 10px;">SLA Alerts<b> ({!v.slaCasesCount})</b></span>
                            </li>
                        </ul>
                    </div>
                    
                    <div class="slds-col">
                        <lightning:button aura:id="newCaseButton" variant="brand" label="New Case" title="New Case" 
                                          onclick="{!c.newCase}" />
                    </div>
                    
                    <div class="slds-col" style="text-align:right">
                        <button class="slds-button" label="Refresh"
                                onclick="{!c.updateTable}">
                            <lightning:icon iconName="action:refresh" alternativeText="Refresh SLA Alerts" size="x-small"/>
                        </button>
                    </div>
                    
                </header>
            </div>
            
            <div class="slds-card__body slds-card__body_inner">
                
                <aura:if isTrue="{!v.slaCasesCount > 0}">
                    <div style="height:500px;">
                        <lightning:datatable 
                                             data="{!v.data}" 
                                             columns="{!v.columns}" 
                                             keyField="Id"
                                             aura:Id="datatable"
                                             onsort = "{!c.updateColumnSorting}"
                                             sortedBy="{!v.sortedBy}"  
                                             onrowaction="{! c.handleRowAction }"
                                             sortedDirection="{!v.sortedDirection}"
                                             hideCheckboxColumn = "true"
                                             />
                        
                    </div>
                    
                    <aura:set attribute ="else">
                        <div class="slds-text-heading_medium slds-align_absolute-center" style="padding: 30px;">
                            No Cases to show here!
                        </div>
                    </aura:set>
                    
                </aura:if>
                
            </div>
        </div>
    
</aura:component>