<!--
Author          : Pinkesh 
Description     : Component for Escalation Contact.[WARNING: THIS COMPONENT IS USED IN 7 DIFFERENT PLACES (AND COMMUNITY). PLEASE TEST ALL SCENARIOS BEFORE DEPLOYING CHANGES!!

Date                 Developer                  JIRA #          Description                                                       
23 Sep 2019         Pinkesh/Sumukh                          SOCC CAR 2 - RunBooks 
16 Jun 2021         Tejaswini                               Adding clickToDial functionality to phone,mobile numbers
17 Jun 2021         Tejaswini                  ESESP-5132   SOCC - Availability changes in SF and community
-->
<aura:component controller="SC_SOCC_EscalationListCtrl" implements="lightning:actionOverride,force:appHostable,flexipage:availableForAllPageTypes,flexipage:availableForRecordHome,force:hasRecordId,forceCommunity:availableForAllPageTypes,force:lightningQuickAction,lightning:utilityItem" access="global">
    <!-- Include JQuery and JQuery UI library for draggable table rows -->
    <!--<ltng:require 
                  scripts="{!join(',', 
                           $Resource.JQuery_JQueryUI  + '/jquery.min.js' ,  
                           $Resource.JQuery_JQueryUI + '/jquery-ui.min.js')
                           }" afterScriptsLoaded="{!c.makeTableDraggable}"/> -->
    
    <!-- attributes coming from the parent component -->
    <aura:attribute name="pdId" type="String"/>
    <aura:attribute name="escalationListId" type="String"/>
    <aura:attribute name="isEditPage" type="Boolean" default="true"/>
    <aura:attribute name="onCaseDetail" type="Boolean" default="false"/>
    
    <!-- attributes -->
    <!-- 1. To Display existing + newly selected Escalation Contacts -->
    <aura:attribute name="escConTableData" type="List"/>
    <aura:attribute name="lAvailabilityRecords" type="List"/>
    
    <!-- 2. To store existing Escalation Contact Ids for delete operation -->
    <aura:attribute name="lEscConId" type="List"/>
    <!-- 3. To store existing + newly selected Authorized Contact Ids -->
    <aura:attribute name="lAuthConId" type="List"/>
    <!-- 4. Order Number of next newly added Escalation Contact -->
    <aura:attribute name="nextOrderNumber" type="Integer" default="1" />
    <!-- 5. To show Edit modal for Escalation Contact -->
    <aura:attribute name="isEditingEscalationContact" type="Boolean" default="false" />
    <!-- 6. To store the edited values of Escalation Contact setting from the Edit each Escalation Contact Modal -->
    <aura:attribute name="escConEditRec" type="SObject" default="{'Id':'', 'Name': '', 'Order_Number__c':'1', 'Action_If_Unreachable__c':''}"/>
    <!-- 7. To store previous order number for each Escalation Contact edit modal to help reorder -->
    <aura:attribute name="oldOrderNumber" type="Integer" default="0" />
    <!-- 8. List of values for Action If Unreachable -->
    <aura:attribute name="lActionIfUnreachable" type="List" />
    <!-- 9. Spinner attribute -->
    <aura:attribute name="elSpinner" type="boolean" default="false"/>
    <!-- 10. To Display existing + newly selected Escalation Via Case Email -->
    <aura:attribute name="escConTableDataForEmail" type="List"/>
    <!-- 11. To store existing Escalation Escalation Via Case Email Ids for delete operation -->
    <aura:attribute name="lEscConIdForEmail" type="List"/>
    <!-- 12. To store existing + newly selected Authorized Contact Ids for Escalation Via Case Email -->
    <aura:attribute name="lAuthConIdForEmail" type="List"/>
    <!-- 13. Total number of Escalations via Case Email -->
    <aura:attribute name="countEscalationsViaCaseEmail" type="Integer" default="0" />
    <!-- 14. To check/uncheck all checkboxes to delete Escalations via Case Email-->
    <aura:attribute name="isSelectAllEscEmail" type="boolean" default="false"/>
    <!-- 14. Delete Recipient button text-->
    <aura:attribute name="deleteRecipientText" type="String" default="{!$Label.c.Jarvis_SC_SOCC_EscalationContact_Edit_DeleteRecipientsText}"/><!--Remove Recipients-->
    <!-- 15. To show Bulk Delete modal for Escalations via Case Email -->
    <aura:attribute name="isBulkDeleteEscalationViaCaseEmailModal" type="Boolean" default="false" />
    <!-- 16. To store number of selected recipients to remove-->
    <aura:attribute name="noOfRecipients" type="String" default=""/>
    
    <!-- For redirecting between tabs -->
    <lightning:workspaceAPI aura:id="workspace"/>
    
    <!-- for utility functions -->
    <lightning:utilityBarAPI aura:id="utilitybar" />
    
    <!--loading spinner start... style=Brand Medium (blue dots)-->
    <aura:if isTrue="{!v.elSpinner}">
        <lightning:spinner alternativeText="{!$Label.c.Jarvis_SC_SOCC_EscalationContact_Edit_SpinnerAltText}" /><!--Loading-->
    </aura:if>
    
    <!-- Method to get and populate the data. Called from the parent Component -->
    <aura:method name="getEscConData" description="Method to populate the Escalation Contacts data">
        <aura:attribute name="pdId" type="String" />
        <aura:attribute name="escalationListId" type="String" />
        <aura:attribute name="isEditPage" type="Boolean" />
        <aura:attribute name="onCaseDetail" type="Boolean" />
    </aura:method>
    
    <!-- Method to make the page editable. Called from the parent Component -->
    <aura:method name="makePageEditable" description="Method to make the page editable">
        <aura:attribute name="isEditPage" type="Boolean" />
    </aura:method>
    
    <!-- Handling SC_SOCC_SendSelectedAuthCon to recieve value from child component SC_SOCC_EscalationList_Add -->
    <!-- Make sure the 'name' of the handler is same as the registered event 'name' in the child component -->
    <aura:handler action="{!c.handleSelectedAuthCon}" event="c:SC_SOCC_SendSelectedAuthCon" name="sendSelectedAuthCon" />

    <!-- Handling SC_SOCC_SendSelectedAuthConForEmail to recieve value from child component SC_SOCC_EscalationViaCaseEmail_Add -->
    <!-- Make sure the 'name' of the handler is same as the registered event 'name' in the child component -->
    <aura:handler action="{!c.handleSelectedAuthConForEmail}" event="c:SC_SOCC_SendSelectedAuthConForEmail" name="sendSelectedAuthConForEmail" />
    
    <!-- Registering event SC_SOCC_SendSelectedEscCon to send back List of selected Escalation Contacts to parent component -->
    <aura:registerEvent name="sendSelectedEscCon" type="c:SC_SOCC_SendSelectedEscCon"/>
    
    <!-- Heading -->
    <div class="slds-grid slds-gutters">
        <div class="slds-col slds-float_left">
            <span><h2 class="sectionHeading slds-text-title_caps">{!v.nextOrderNumber -1}&nbsp;{!$Label.c.Jarvis_SC_SOCC_EscalationContact_Edit_EscalationsViaPhoneHeading}</h2></span><!--Escalations via Phone-->
        </div>
        <aura:if isTrue="{!v.isEditPage}">
            <div class="slds-col">
                <span class="slds-float_right"><lightning:button variant="brand" label="{!$Label.c.Jarvis_SC_SOCC_EscalationContact_Edit_AddEscalationContactsButton}" onclick="{!c.openEscalationContactAddModal}" /></span><!--Add Escalation Contacts-->
            </div>
        </aura:if>
    </div>
    
    <!-- Table to show escalation contacts -->
    <div class="slds-p-horizontal_small slds-p-top_small slds-p-bottom_xx-large">
        <table class="slds-table slds-table_cell-buffer slds-table_bordered" style="width:100%" id="myTable">
            <!--Table Header-->
            <thead>
                <tr class="slds-line-height_reset">
                    <th class="slds-text-title_caps" scope="col" style="width: 7%; text-align: center;">
                        <div class="cell-content" style="word-break: break-word;">{!$Label.c.Jarvis_SC_SOCC_EscalationContact_Edit_TableColumnOrder}</div><!--Order-->
                    </th>
                    <th class="slds-text-title_caps" scope="col" style="width: 2%;">

                    </th>
                    <th class="slds-text-title_caps" scope="col" style="width: 13%;">
                        <div class="cell-content" >{!$Label.c.Jarvis_SC_SOCC_EscalationContact_Edit_TableColumnContactName}</div><!--Contact Name-->
                    </th>
                    <th class="slds-text-title_caps" scope="col" style="width: 12%;">
                        <div class="cell-content" >{!$Label.c.Jarvis_SC_SOCC_EscalationContact_Edit_TableColumnEmail}</div><!--Email-->
                    </th>
                    <th class="slds-text-title_caps" scope="col" style="width: 11%;">
                        <div class="cell-content" >{!$Label.c.Jarvis_SC_SOCC_EscalationContact_Edit_TableColumnPrimaryContactMethod}</div><!--Primary Contact Method-->
                    </th>
                    <th class="slds-text-title_caps" scope="col" style="width: 11%;">
                        <div class="cell-content" >{!$Label.c.Jarvis_SC_SOCC_EscalationContact_Edit_TableColumnSecondaryContactMethod}</div><!--Secondary Contact Method-->
                    </th>
                    <th class="slds-text-title_caps" scope="col" style="width: 17%;">
                        <div class="cell-content" >{!$Label.c.Jarvis_SC_SOCC_EscalationContact_Edit_TableColumnActionIfUnavailable}</div><!--Action If Unavailable-->
                    </th>
                    <th class="slds-text-title_caps index" scope="col">
                        <div class="cell-content" >{!$Label.c.Jarvis_SC_SOCC_EscalationContact_Edit_TableColumnAvailability}</div><!--Availability-->
                    </th>
                </tr>
            </thead>
            
            <!--Table Body -->
            <tbody>
                <aura:iteration items="{!v.lAvailabilityRecords}" var="escConRec">
                    <tr class="slds-hint-parent">
                        <td>
                            <div class="slds-grid">
                                <aura:if isTrue="{!v.isEditPage}">
                                    <span id="{!'edit_Esc_Order_Number-' + escConRec.escCon.Order_Number__c}"  onclick="{!c.editEachEscCon}">
                                        <lightning:buttonicon iconName="utility:edit" class="editIcon" variant="bare" title="{!$Label.c.Jarvis_SC_SOCC_EscalationContact_Edit_EditButtonText}" alternativeText="{!$Label.c.Jarvis_SC_SOCC_EscalationContact_Edit_EditButtonText}" /><!--Edit - title-->
                                    </span>
                                    <span id="{!'del_Esc_Order_Number-' + escConRec.escCon.Order_Number__c}"  onclick="{!c.delEachEscCon}">
                                        <lightning:buttonicon iconName="utility:delete" class="delIcon" variant="bare" title="{!$Label.c.Jarvis_SC_SOCC_EscalationContact_Edit_RemoveButtonText}" alternativeText="{!$Label.c.Jarvis_SC_SOCC_EscalationContact_Edit_RemoveButtonText}" /><!--Remove - title-->
                                    </span>
                                </aura:if>
                                &nbsp;&nbsp;
                                <span>{!escConRec.escCon.Order_Number__c}</span>
                            </div>
                        </td>
                        <!--<td>
                            <div class="grid-content">
                            <aura:if isTrue="{!v.isEditPage}">
                                    <span id="{!'edit_Esc_Order_Number-' + escConRec.escCon.Order_Number__c}"  onclick="{!c.editEachEscCon}">
                                        <lightning:buttonicon iconName="utility:edit" class="editIcon" variant="bare" title="Edit" alternativeText="Edit" />
                                    </span>
                                    <span id="{!'del_Esc_Order_Number-' + escConRec.escCon.Order_Number__c}"  onclick="{!c.delEachEscCon}">
                                        <lightning:buttonicon iconName="utility:delete" class="delIcon" variant="bare" title="Remove" alternativeText="Remove" />
                                    </span>
                                </aura:if>
                            </div>
                        </td>
                        <td>
                            <div class="cell-content">
                               &nbsp;&nbsp;
                                <span>{!escConRec.escCon.Order_Number__c}</span>
                            </div>
                        </td>-->
                        <td>
                            <aura:if isTrue="{!escConRec.isOOONow}">
                                <lightning:icon iconName="utility:warning" class="warningIcon" variant="bare" alternativeText="Currently OOO" title="Currently OOO" size="x-small" />
                            </aura:if>
                        </td>
                        <td>
                            <div class="cell-content">
                                {!escConRec.escCon.Authorized_Contact__r.Contact_Name__r.Name}       
                            </div>
                        </td>
                        <td>
                            <div class="cell-content" style="word-break: break-word;">
                                {!escConRec.escCon.Authorized_Contact__r.Contact_Name__r.Email}
                            </div>
                        </td>
                        <td>
                            <div class="slds-grid cell-content">
                                <aura:if isTrue="{!escConRec.escCon.Authorized_Contact__r.Contact_Name__r.Primary_Contact_Method__c == 'Mobile'}">
                                    <!--<span>
                                        <lightning:buttonicon iconName="utility:phone_portrait" class="mobile" variant="bare" title="Mobile" alternativeText="Mobile" />
                                    </span>
                                    &nbsp;
                                    <span style="word-break: break-word;">{!escConRec.escCon.Authorized_Contact__r.Contact_Name__r.MobilePhone}</span>-->
                                    <span style="word-break: break-word;"><lightning:clickToDial value="{!escConRec.escCon.Authorized_Contact__r.Contact_Name__r.MobilePhone}"> </lightning:clickToDial></span>
                                </aura:if>
                                <aura:if isTrue="{!escConRec.escCon.Authorized_Contact__r.Contact_Name__r.Primary_Contact_Method__c == 'Phone'}">
                                    <!--<span>
                                        <lightning:buttonicon iconName="utility:dialing" class="phone" variant="bare" title="Phone" alternativeText="Phone" />
                                    </span>
                                    &nbsp;
                                    <span style="word-break: break-word;">{!escConRec.escCon.Authorized_Contact__r.Contact_Name__r.Phone}</span>-->
                                    <span style="word-break: break-word;"><lightning:clickToDial value="{!escConRec.escCon.Authorized_Contact__r.Contact_Name__r.Phone}"></lightning:clickToDial></span>
                                </aura:if>
                            </div>
                        </td>
                        <td>
                            <div class="slds-grid cell-content">
                                <aura:if isTrue="{!escConRec.escCon.Authorized_Contact__r.Contact_Name__r.Secondary_Contact_Method__c == 'Mobile'}">
                                    <!--<span>
                                        <lightning:buttonicon iconName="utility:phone_portrait" class="mobile" variant="bare" title="Mobile" alternativeText="Mobile" />
                                    </span>
                                    &nbsp;
                                    <span style="word-break: break-word;">{!escConRec.escCon.Authorized_Contact__r.Contact_Name__r.MobilePhone}</span>-->
                                    <span style="word-break: break-word;"><lightning:clickToDial value="{!escConRec.escCon.Authorized_Contact__r.Contact_Name__r.MobilePhone}"></lightning:clickToDial></span>
                                </aura:if>
                                <aura:if isTrue="{!escConRec.escCon.Authorized_Contact__r.Contact_Name__r.Secondary_Contact_Method__c == 'Phone'}">
                                    <!--<span>
                                        <lightning:buttonicon iconName="utility:dialing" class="phone" variant="bare" title="Phone" alternativeText="Phone" />
                                    </span>
                                    &nbsp;
                                    <span style="word-break: break-word;">{!escConRec.escCon.Authorized_Contact__r.Contact_Name__r.Phone}</span>-->
                                    <span style="word-break: break-word;"><lightning:clickToDial value="{!escConRec.escCon.Authorized_Contact__r.Contact_Name__r.Phone}"></lightning:clickToDial></span>
                                </aura:if>
                            </div>
                        </td>
                        <td>
                            <div class="cell-content">
                                {!escConRec.escCon.Action_If_Unreachable__c}
                            </div>
                        </td>
                        <td>
                            <!-- Show availability component to display contact's availability -->
                            <div class="cell-content">
                                <!--{!escConRec.escCon.Order_Number__c}-->
                                <c:SC_SOCC_ShowAvailability escConRec="{!escConRec}" />
                            </div>
                            <!-- availability component -->
                        </td>
                    </tr>
                </aura:iteration>
            </tbody>
            
        </table>
        
        
        <!-- Placeholder for SC_SOCC_EscalationContact_Add and SC_SOCC_EscalationViaCaseEmail_Add component to open a Modal -->
        <div aura:id="EscalationContactAddPlaceHolder">
            {!v.body}
        </div>
        
        <!-- Modal for Editing Escalation Contacts -->
        <aura:if isTrue="{!v.isEditingEscalationContact}">
            <div  style="height: 100%;">
                <section role="dialog" tabindex="-1" class="slds-modal slds-fade-in-open slds-modal_small" aria-labelledby="modal-heading-01" aria-modal="true" aria-describedby="modal-content-id-1">
                    <div class="slds-modal__container">
                        <header class="slds-modal__header">
                            <button class="slds-button slds-button_icon slds-modal__close slds-button_icon-inverse" onclick="{!c.closeEditEscConModal}" title="{!$Label.c.Jarvis_SC_SOCC_EscalationContact_Edit_ModalCloseButtonTitle}"><!--Close - title-->
                                <lightning:icon class="white slds-icon_small" iconName="utility:close"/>
                                <span class="slds-assistive-text">{!$Label.c.Jarvis_SC_SOCC_EscalationContact_Edit_ModalCloseButtonTitle}</span><!--Close-->
                            </button>
                            <h2 id="modal-heading-01" class="slds-modal__title slds-hyphenate sectionHeading">{!$Label.c.Jarvis_SC_SOCC_EscalationContact_Edit_EditButtonText}&nbsp;{!v.escConEditRec.Name}</h2><!--Edit-->
                        </header>
                        <div class="slds-modal__content slds-p-around_medium" id="modal-content-id-1">
                            <lightning:recordEditForm objectApiName="SC_SOCC_Escalation_Contact__c">
                                <lightning:input type="number" aura:id="editOrderNumber" label="{!$Label.c.Jarvis_SC_SOCC_EscalationContact_Edit_OrderNumberInput}" value="{!v.escConEditRec.Order_Number__c}" onkeyup="{!c.validateOrderNumber}" required="true" variant="label-inline"></lightning:input><!--Order Number-->
                                <lightning:select name="Action If Unreachable" label="{!$Label.c.Jarvis_SC_SOCC_EscalationContact_Edit_TableColumnActionIfUnavailable}" value="{!v.escConEditRec.Action_If_Unreachable__c}" variant="label-inline" class="slds-form-element_horizontal"><!--Action If Unreachable-->
                                    <aura:iteration items="{!v.lActionIfUnreachable}" var="eachAction">
                                        <option text="{!eachAction.label}" value="{!eachAction.value}" selected="{!eachAction.selected}"/>
                                    </aura:iteration>
                                </lightning:select>
                            </lightning:recordEditForm>
                        </div>
                        <footer class="slds-modal__footer">
                            <button class="slds-button slds-button_neutral" onclick="{!c.closeEditEscConModal}">{!$Label.c.Jarvis_SC_SOCC_EscalationContact_Edit_ModalFooterCancelButton}</button><!--Cancel-->
                            <button class="slds-button slds-button_brand" onclick="{!c.saveEachEscCon}">{!$Label.c.Jarvis_SC_SOCC_EscalationContact_Edit_ModalFooterSaveButton}</button><!--Save-->
                        </footer>
                    </div>
                </section>
                <div class="slds-backdrop slds-backdrop_open"></div>
            </div>
        </aura:if>
    </div>


    <!-- Escalation Via Case Email section -->
    <!-- Heading -->
    <div class="slds-grid slds-gutters">
        <div class="slds-col slds-float_left">
            <span><h2 class="sectionHeading slds-text-title_caps">{!v.countEscalationsViaCaseEmail}&nbsp;{!$Label.c.Jarvis_SC_SOCC_EscalationContact_Edit_NotifyViaCaseEmailHeading}</h2></span><!--Notify Via Case Email-->
        </div>
        <aura:if isTrue="{!v.isEditPage}">
            <div class="slds-col">
                <span class="slds-float_right slds-p-left_small"><lightning:button variant="brand" label="{!$Label.c.Jarvis_SC_SOCC_EscalationContact_Edit_AddRecipientsButton}" onclick="{!c.openEscalationContactAddModalForEmail}" /></span><!--Add Recipients-->
                <span class="slds-float_right"><lightning:button variant="destructive" label="{!format($Label.c.Jarvis_SC_SOCC_EscalationContact_Edit_RemoveSelectedRecipientsText, v.noOfRecipients)}" onclick="{!c.showBulkDeleteEscalationViaCaseEmailModal}" /></span><!--{!v.deleteRecipientText} - dynamic-->
            </div>
        </aura:if>
    </div>

    <!-- Table to show Escalation Via Case Email -->
    <div class="slds-p-horizontal_small slds-p-top_small slds-p-bottom_xx-large">
        <table class="slds-table slds-table_cell-buffer slds-table_bordered" style="width:100%" id="myTable">
            <!--Table Header-->
            <thead>
                <tr class="slds-line-height_reset">
                    <aura:if isTrue="{!v.isEditPage}">
                        <th class="table-fixed-cell" style="width: 7%;">           
                            <label class="slds-checkbox">
                                    <ui:inputCheckbox value="{!v.isSelectAllEscEmail}" change="{!c.handleSelectAllEscViaCaseEmail}" aura:id="selectAllEscEmail"/>
                                    <span class="slds-checkbox--faux" />
                                    <span class="slds-form-element__label"></span>
                            </label>
                        </th>
                    </aura:if>
                    <th class="slds-text-title_caps" scope="col" style="width: 20%;">
                        <div class="cell-content" >{!$Label.c.Jarvis_SC_SOCC_EscalationContact_Edit_TableColumnContactName}</div><!--Contact Name-->
                    </th>
                    <th class="slds-text-title_caps" scope="col" style="width: 18%;">
                        <div class="cell-content" >{!$Label.c.Jarvis_SC_SOCC_EscalationContact_Edit_TableColumnEmail}</div><!--Email-->
                    </th>
                    <th class="slds-text-title_caps" scope="col" style="width: 18%;">
                        <div class="cell-content" >{!$Label.c.Jarvis_SC_SOCC_EscalationContact_Edit_TableColumnSMSNotification}</div><!--SMS Notification-->
                    </th>
                    <th class="slds-text-title_caps" scope="col" style="width: 19%;">
                        <div class="cell-content" >{!$Label.c.Jarvis_SC_SOCC_EscalationContact_Edit_TableColumnAccount}</div><!--Account-->
                    </th>
                    <th class="slds-text-title_caps" scope="col">
                        <div class="cell-content" >{!$Label.c.Jarvis_SC_SOCC_EscalationContact_Edit_TableColumnServiceAccount}</div><!--Service Account-->
                    </th>
                </tr>
            </thead>

            <!--Table Body -->
            <tbody>
                <aura:iteration items="{!v.escConTableDataForEmail}" var="escConRecForEmail">
                    <tr class="slds-hint-parent">
                        <aura:if isTrue="{!v.isEditPage}">
                            <td>
                                <label class="slds-checkbox">
                                <ui:inputCheckbox aura:id="checkEscEmail" value="{!escConRecForEmail.isSelected}" text="{!escConRecForEmail.Authorized_Contact__c}" change="{!c.handleSelectEscViaCaseEmail}"/>
                                <span class="slds-checkbox--faux" />
                                <span class="slds-form-element__label"></span>
                                </label>
                                <span id="{!'del_EscViaCaseEmail-' + escConRecForEmail.Authorized_Contact__r.Contact_Name__c}"  onclick="{!c.delEachEscViaCaseEmail}">
                                    <lightning:buttonicon iconName="utility:delete" class="delIcon" variant="bare" title="{!$Label.c.Jarvis_SC_SOCC_EscalationContact_Edit_RemoveButtonText}" alternativeText="{!$Label.c.Jarvis_SC_SOCC_EscalationContact_Edit_RemoveButtonText}" /><!--Remove-->
                                </span>
                            </td>
                        </aura:if>
                        <td>
                            <div class="cell-content">
                                {!escConRecForEmail.Authorized_Contact__r.Contact_Name__r.Name}
                            </div>
                        </td>
                        <td>
                            <div class="cell-content">
                                {!escConRecForEmail.Authorized_Contact__r.Contact_Name__r.Email}
                            </div>
                        </td>
                        <td>
                            <div class="cell-content">
                                {!escConRecForEmail.Authorized_Contact__r.Contact_Name__r.SMS_Notifications__c}
                            </div>
                        </td>
                        <td>
                            <div class="cell-content">
                                {!escConRecForEmail.Authorized_Contact__r.Policy_Domain__r.Account_Name__r.Name}
                            </div>
                        </td>
                        <td>
                            <div class="cell-content">
                                {!escConRecForEmail.Authorized_Contact__r.Policy_Domain__r.Service_Account__r.Name}
                            </div>
                        </td>
                    </tr>
                </aura:iteration>
            </tbody>

        </table>
    </div>

    <aura:if isTrue="{!v.isEditPage}">
        <div class="slds-grid slds-gutters slds-float_right slds-var-p-around_medium">
            <button class="slds-button slds-button_neutral" onclick="{!c.redirectToPD}">{!$Label.c.Jarvis_SC_SOCC_EscalationContact_Edit_ModalFooterCancelButton}</button><!--Cancel-->
            <button class="slds-button slds-button_brand" onclick="{!c.save}">{!$Label.c.Jarvis_SC_SOCC_EscalationContact_Edit_ModalFooterSaveButton}</button><!--Save-->
        </div>
    </aura:if>

    <!-- Modal for Editing Escalations via Case Email -->
    <aura:if isTrue="{!v.isBulkDeleteEscalationViaCaseEmailModal}">
        <div  style="height: 100%;">
            <section role="dialog" tabindex="-1" class="slds-modal slds-fade-in-open slds-modal_small" aria-labelledby="modal-heading-01" aria-modal="true" aria-describedby="modal-content-id-1">
                <div class="slds-modal__container">
                    <header class="slds-modal__header">
                        <button class="slds-button slds-button_icon slds-modal__close slds-button_icon-inverse" onclick="{!c.closeBulkDeleteEscalationViaCaseEmailModal}" title="Close">
                            <lightning:icon class="white slds-icon_small" iconName="utility:close"/>
                            <span class="slds-assistive-text">{!$Label.c.Jarvis_SC_SOCC_EscalationContact_Edit_ModalCloseButtonTitle}</span><!--Close-->
                        </button>
                        <h2 id="modal-heading-01" class="slds-modal__title slds-hyphenate sectionHeading">{!format($Label.c.Jarvis_SC_SOCC_EscalationContact_Edit_RemoveSelectedRecipientsText, v.noOfRecipients)}</h2><!--{!v.deleteRecipientText} - dynamic-->
                    </header>
                    <div class="slds-modal__content slds-p-around_large slds-text-heading_small" style="text-align:center;" id="modal-content-id-1">
                        <h2>{!$Label.c.Jarvis_SC_SOCC_EscalationContact_Edit_ModalBodyConfirmEdit}</h2><!--Do you want to proceed?-->
                    </div>
                    <footer class="slds-modal__footer">
                        <button class="slds-button slds-button_neutral" onclick="{!c.closeBulkDeleteEscalationViaCaseEmailModal}">{!$Label.c.Jarvis_SC_SOCC_EscalationContact_Edit_ModalFooterGoBackButton}</button><!--Go Back-->
                        <button class="slds-button slds-button_brand" onclick="{!c.deleteEscViaCaseEmail}">{!$Label.c.Jarvis_SC_SOCC_EscalationContact_Edit_ModalFooterYesButton}</button><!--Yes!-->
                    </footer>
                </div>
            </section>
            <div class="slds-backdrop slds-backdrop_open"></div>
        </div>
    </aura:if>





    
    
</aura:component>