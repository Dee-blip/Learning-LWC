<aura:component controller="SF1_MobileTaskManagementAppController" implements="force:lightningQuickActionWithoutHeader,force:hasRecordId,force:appHostable,flexipage:availableForAllPageTypes" access="global" >

	<aura:attribute name="opptyId" type="Id" />
	<aura:attribute name="orderApproval" type="Order_Approval__c"/>
	<aura:attribute name="oaId" type="Id"/>
	<aura:attribute name="listOfTasks" type="Task[]"/>
	<aura:attribute name="taskFilterOptions" type="List" default="['Open' , 'Closed']" />
	<aura:attribute name="oadetails" type="List" />

	<aura:handler name="init" value="{!this}" action="{!c.doInit}"/>
	<aura:registerEvent name="nagivateToOA" type="c:SF1_NavigationBetweenComponentsEvent"/>
	<aura:attribute name="enableNewTask" type="Boolean" />
	<aura:attribute name="tasksAvailable" type="Boolean" />

		<!-- header at the top -->
		<table style="table-layout: fixed;">
		<tr>
			    	<div id="scrollToHeader" class="sectionOne slds-is-relative">
			            <div class="" id="" style="height: 35px;margin-top: 1px;margin-bottom: 7px;background-color: rgb(244, 246, 249);">
			                <div  class="">
			                    <div class="" style="margin:0.70px;">
			                        <div class="slds-clearfix">
			                            <div class="slds-float_left">
			                                <lightning:button variant="neutral" iconName="utility:chevronleft" label=" Opportunity List"  type="submit" onclick="{!c.navigateBackToTaskApp}" />
			                            </div>
			                            <div class="slds-float_right">
			                                <lightning:button variant="neutral" iconName="utility:chevronright" iconPosition="right" label="New Task"  type="submit" onclick="{!c.navigateToCreateNewTaskCmp}" disabled="{!v.enableNewTask}"/>
			                            </div>
			                        </div>
													</div>
			                </div>
			            </div>
			        </div>
			</tr>
			<tr>
			</tr>

			<tr>

		        <!-- tabs for OA and task list -->

		        <div class="slds-tabs--scoped slds-show" aura:Id = "mainTabId">
		            <ul class="slds-tabs--scoped__nav" role="tablist">
		                <li class="slds-tabs--scoped__item slds-active slds-size_1-of-2" title="Item One" role="presentation"
		                    aura:id="oppDetId" onclick="{!c.switchTabToOA}">
		                    <a class="slds-tabs--scoped__link" href="javascript:void(0);" role="tab" tabindex="0"
		                       aria-selected="true" aria-controls="tab-scoped-1" id="tab-scoped-1__item">
		                        <lightning:icon iconName="custom:custom45" size="medium"/>
		                        &nbsp;OA DETAILS
		                    </a>
		                </li>
		                <li class="slds-tabs--scoped__item slds-size_1-of-2" title="Item Two" role="presentation"
		                    aura:id="prodDetId" onclick="{!c.switchTabToTasks}">
		                    <a class="slds-tabs--scoped__link" href="javascript:void(0);" role="tab"
		                       tabindex="-1" aria-selected="false" aria-controls="tab-scoped-2"
		                       id="tab-scoped-2__item">
		                        <lightning:icon iconName="standard:task" size="medium"/>
		                        &nbsp;TASKS
		                    </a>
		                </li>
		            </ul>
		        </div>


		        <!-- details under OA DETAILS TAB -->
		        <div aura:id="oppDetBodyId" class="slds-tabs--scoped__content slds-show" role="tabpanel" aria-labelledby="tab-scoped-1__item">
		            <div class="relatedOA" style="padding:5px">
		                <div class="parentContainer">
											<aura:if isTrue="{!not(v.enableNewTask)}">
												<div class="slds-media__body" style="border:5px;">
														<div class="slds-tile__detail slds-text-body--small" style="margin-left: 10px; padding: 1px;font-size:13px;">
<ui:scrollerWrapper class="sWrapTest">
															<aura:iteration items="{!v.oadetails}" var="oa" indexVar="key">
                                                                
																		<aura:if isTrue="{!equals(oa.key,'Name')}">
																			<ul style="margin-top: 1px;">
												                <li class="slds-form-element slds-hint-parent slds-border_bottom">
												                    <span class="slds-form-element__label">
																							{!oa.key}
																						</span>
												                    <div class="slds-form-element__control" onclick="{!c.goToOARecord}">
												                        <span class="slds-form-element__static" style = "color:blue;white-space: normal;word-wrap: break-word;text-decoration:underline">
												                              {!oa.value}
												                        </span>
												                    </div>
												                 </li>
												             </ul>

																	 <aura:set attribute="else">
																		 <ul style="margin-top: 5px;">
					 						                <li class="slds-form-element slds-hint-parent slds-border_bottom">
					 						                    <span class="slds-form-element__label">{!oa.key}</span>
					 						                    <div class="slds-form-element__control">
					 						                        <span class="slds-form-element__static" style = "color:black;white-space: normal;word-wrap: break-word;">
					 						                              {!oa.value}
					 						                        </span>
					 						                    </div>
					 						                 </li>
					 						             </ul>
																	 </aura:set>
														</aura:if>
													</aura:iteration>
                                                            </ui:scrollerWrapper>

														</div>
												</div>
												</aura:if>
												<aura:if isTrue="{!v.enableNewTask}">
													<h3 style="font-weight:400;" class="" title="Task">
															<b>Order Approval for this opportunity has not been created yet.</b>
															<br></br>
															<br></br>
															<b>Navigate back to opportunity and click on create Order Approval.</b>
													</h3>
											 </aura:if>

		                </div>
		            </div>
		        </div>




		        <!-- details under TASKS TAB -->
		        <!-- list of tasks with summary ###task -->
		        <div aura:id="prodDetBodyId" class="slds-tabs--scoped__content slds-hide" role="tabpanel" aria-labelledby="tab-scoped-2__item">
		            <div class="slds-size_1-of-1" style="padding-left:10px;padding-right:10px;">
									<lightning:select aura:id="filterTask" name="" label="" onchange="{!c.changeFilterForTask}">
														<aura:iteration items="{!v.taskFilterOptions}" var="filter">
		                            <option text="{!filter}" label="{!filter}"/>
		                        </aura:iteration>
		              </lightning:select>
		            </div>

								<aura:if isTrue="{!v.tasksAvailable}">
		            <div class="relatedTasks" style="">
		                <aura:iteration var="task" items="{!v.listOfTasks}">
		                    <span>
		                        <div class="slds" style="padding:10px">
		                            <div class="slds-media">
		                                <div class="slds-media__body">
		                                    <div class="parentContainer">
		                                        <div class="slds-media__body slds-box" onclick="{!c.goToTaskCustomInterface}" id="{!task.Id}">
																							<table style="table-layout: fixed;">
																								<tr>
																									<td style="width: 7%;">
																										<lightning:icon iconName="utility:task" size="xx-small"/>
																									</td>

																									<td style="width: 87%;">
																										<h3 style="font-weight:400;" class="" title="Opportunity">{!task.Subject}</h3>
																									</td>
																								</tr>
																							</table>

																							<div class="slds-tile__detail slds-text-body--small">
		                                                <dl class="slds-list--horizontal slds-wrap">
		                                                    <dt class="slds-item--label slds-text-color--weak slds-truncate" title="Third Label">Status:</dt>
		                                                    <dd class="slds-item--detail slds-truncate">{!task.Status}</dd>
		                                                    <dt class="slds-item--label slds-text-color--weak slds-truncate" title="Second Label">Priority:</dt>
		                                                    <dd class="slds-item--detail slds-truncate">{!task.Priority}</dd>
		                                                </dl>
		                                            </div>
		                                        </div>
		                                    </div>
		                                </div>
		                            </div>
		                        </div>
		                    </span>
		                </aura:iteration>
		            </div>
							</aura:if>

							<aura:if isTrue="{!not(v.tasksAvailable)}">
								<h3 style="font-weight:400;" class="" title="Task">
										<br></br>
										<br></br>
										<b>&nbsp;No Tasks are created under this category.</b>
										<br></br>
										<br></br>
								</h3>
							</aura:if>
		        </div>

			</tr>
		</table>
</aura:component>