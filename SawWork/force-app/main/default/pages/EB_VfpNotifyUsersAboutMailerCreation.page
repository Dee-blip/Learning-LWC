<!-- Modified : 29/3/2011 
CR 1029711 CNotify: Standardize Action Poller Content, Create Mailer 
    Revamp the layout of the page, use static resource for styling
    11/14/2011 : CR 1403947 CNotify: Enhancement, Navigate directly to the Mailer post Mailer Creation 
-->
<apex:page sidebar="false" showHeader="true" tabStyle="EB_AkaMailer__c" controller="EB_CtrlMailerWizard">
<apex:stylesheet value="{!$Resource.EB_ActionPollerStyleSheet}"/>
<apex:form id="MailerDetails" >
<html>
<body>
        <table>
            <tr><td colspan="2" class="tdTopHeader" align="center">Create Mailer Wizard</td></tr>
            <tr>
            <td class="tdFieldValue">
                <table>
                    <tr>
                        <td class="tdHeaderFieldLabel">Notification Type</td>
                        <td class="tdHeaderFieldValue">{!MailerIncidentType}</td>
                    </tr>
                    <tr>
                        <td class="tdHeaderFieldLabel">Mailer Type</td>
                        <td class="tdHeaderFieldValue">{!MailerType}</td>
                    </tr>
                </table>
            </td>
            <td class="tdFieldValue">
                <table>
                    <tr>
                        <td>
                            <p class="pResponse">
                            A new request for creating a new Mailer has been submitted and is currently in a queued state. 
                            </p>
                            <p class="pResponse">
                            However please note that the processing time is also based on the total number of requests that are in the queue and the total number of accounts and contacts that are tied to a Mailer.
                            </p>
                            <p class="pResponse">
                            Once the entire request has been successfully processed, you would be redirected to the mailer screen, and would be notified via an email. In the meantime, you may resume others tasks/activities. 
                            </p>
                            <p class="pResponse">
                            Again your patience and support are much appreciated.
                            </p>
                        </td>
                    </tr>
                </table>
            </td>
        </tr>
        <tr>
            <td colspan="2">
                <table width="100%">
                    <tr height="50">
                        <td width="50" height="50" class="tdFieldBlueBold">
                            &nbsp;<img src="{!MailerDetails}" id="MailerStatus"/> &nbsp;
                        </td>
                        <td class="tdFieldBlueBold">
                            <apex:outputText value="{!StatusMessage}"></apex:outputText>
                        </td>
                        <!-- The following thing is never showed on the screen any more, page redirects to Mailer details page when operation completes -->
						<td width="75" class="tdFieldBlueBold">
                            <apex:outputLink value="{!CurrentMailerLink}" id="MailerLink" rendered="{!renderMailerLink}"> Finish </apex:outputLink>
                        </td>
                    </tr>
                </table>
            </td>
        </tr>
        </table>
</body>
</html>
</apex:form>
<br/>
<br/>
<apex:form >
<apex:actionPoller action="{!getmailerStatus}" reRender="MailerDetails" interval="15"/>
</apex:form>
    

</apex:page>