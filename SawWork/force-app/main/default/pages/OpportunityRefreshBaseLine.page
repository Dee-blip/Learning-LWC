<apex:page controller="CustomButtonController" action="{!executeRefreshBaseline}" lightningStylesheets="true">
  <apex:includeScript value="/lightning/lightning.out.js" />
  <style>
    .popupBackground {
      /* Background color */
      background-color: black;
      opacity: 0.20;
      filter: alpha(opacity = 20);

      /* Dimensions */
      width: 100%;
      height: 100%;
      top: 0;
      left: 0;
      z-index: 998;
      position: absolute;

      /* Mouse */
      cursor: wait;
    }

    .PopupPanel {
      /* Background color */

      /* Dimensions */
      left: 50%;
      width: 200px;
      margin-left: -100px;
      top: 50%;
      height: 50px;
      margin-top: -25px;
      z-index: 999;
      position: fixed;

      /* Mouse */
      cursor: pointer;
    }

  </style>

  <div id="lightning"/>
  <script>
    if ("{! JSENCODE($User.UIThemeDisplayed) }" == "Theme4t") { // SFDC-5897 Added JSENCODE

      $Lightning.use("c:SF1_ProductQuickActionApp", function () {
        $Lightning.createComponent("c:SF1_RefreshContractBaselineCmp", {opportunityID: "{!JSENCODE(opportunityID)}", contractID: "{!JSENCODE(contractID)}"}, "lightning", function (cmp) {  // SFDC-5897 Added JSENCODE
          // do some stuff
        });
      });
    }
  </script>

  <apex:form id="formId" rendered="{! $User.UIThemeDisplayed  != 'Theme4t' }">
    <apex:actionStatus id="showLoading" stopText="">
      <apex:facet name="start">
        <div>
          <div class="popupBackground"/>
          <div class="PopupPanel">
            <table border="0" width="100%" height="100%">
              <tr>
                <td align="center"><img src="/img/loading32.gif"/></td>
              </tr>
            </table>
          </div>
        </div>
      </apex:facet>
    </apex:actionStatus>
    <apex:outputLink value="/{!opportunityID}" id="back">
      Back to Opportunity
    </apex:outputLink>
    <apex:pageMessages ></apex:pageMessages>
    <apex:outputPanel rendered="{!!showError}">
      <apex:outputPanel >
        <apex:pageMessage summary=" Are you sure you want to refresh baseline? " severity="warning" strength="3"/>
      </apex:outputPanel>
      <apex:commandButton value="Yes" style="float:left;width:50px;height:25px;font-weight:bold;" action="{!refreshBaseline}" status="showLoading" reRender="formId"/>
      <apex:commandButton value="No" status="showLoading" action="{!executeBackToOpportunity}" style="float:left;width:50px;height:25px;font-weight:bold;"/>
    </apex:outputPanel>
  </apex:form>

</apex:page>