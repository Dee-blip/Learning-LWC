<!--
    Author   : Vamsee
    Date     : 19th July 2016
    Purpose  : This page is to create the Special Instruction from
               Special Instruction Template [CR : 3470841]
-->

<apex:page standardController="Special_Instructions__c" extensions="SC_SpecialInstructionTemplateCtrl" id="specialInstructionPage" title="Special Instructions" lightningStylesheets="true">
     <style>
        .picklist {
            margin-Right: 2%;
            color: #454A4D;
            font-size: 10.9px;
        }
        .createsection{
          width: 40%;
          float: left;
          vertical-align:top;
          }
         
         .previewsection{
          width: 59%;
          float: right;
          vertical-align:top;
         }
         
         #specialInstructionPage\:specialInstructionform\:specialPageBlock\:preview > .pbSubheader{
          margin-top: 0px !important; 
         }
    </style>
    <apex:outputPanel rendered="{!templateFlag}">
          <apex:form id="specialInstructionform">
              <apex:pageBlock id="specialPageBlock" title="Special Instructions">
                  <div class="MaindivClass" >
                     <div class="createsection">
                      <center>
                            <apex:actionstatus id="actStatusId">
                                  <apex:facet name="start">
                                      <div class="waitingSearchDiv"
                                           style="background-color: #fbfbfb; height: 100%; opacity: 0.65; width: 100%;position:fixed;z-index:1000;">
                                          <div class="waitingHolder" style="top: 50%; width: 91px; position: fixed;z-index: 1001; left: 50%;">
                                              <img class="waitingImage" src="/img/loading.gif"
                                                   title="Please Wait.." /> <span class="waitingDescription">Loading..</span>
                                          </div>
                                      </div>
                                  </apex:facet>
                              </apex:actionstatus> 
                             </center>
                         <apex:pageBlockSection columns="1" title="Special Instruction from Template" collapsible="false">
                             <apex:pagemessages />
                             <apex:inputField value="{!specialInstructionsObject.Start_Date__c}" />
                             <apex:inputField value="{!specialInstructionsObject.Expiration_Date__c}" />
                         <apex:selectList size="1" multiselect="false" id="status" value="{!templateTitle}" >
                                 <apex:actionSupport event="onchange" action="{!loadPreview}" reRender="preview" status="actStatusId"/>
                                  <b class ="picklist">Select Template</b>
                                 <apex:selectOptions value="{!templateTitles}"></apex:selectOptions>
                             </apex:selectList><br/><br/></apex:pageBlockSection>
                         
                            <apex:commandButton action="{!createSpecialInstruction}"
                                                 value="Save"
                                                 status="actStatusId"
                                                 style="margin-left:35%;margin-right:1.5%;"
                                                reRender="specialPageBlock">
                            <apex:param name="isTemplate" value="true"/>
              </apex:commandButton>
                             <apex:commandButton action="{!cancel}"
                                                 value="Cancel"
                                                 />
                              
                  </div>
                  <div id="previewDiv" class= "previewsection"> 
                      
                      <apex:pageBlockSection columns="1" title=" Preview: Special Instruction Template" collapsible="false" id="preview" >
                          <apex:outputText label="Title " value="{!titleOutputText}"/>
                          <apex:outputText label="Instructions " value="{!instructionsOutputText}" escape="false"/>
                          <apex:outputText label="Show for Record Types " value="{!recordTypesOutputText}"/>
                          <apex:outputText style="margin-left:7px;" label="Flag Icon " value="{!flagIconOutputText}">
                          <apex:image rendered="{!flagIconRender}" value="https://{!logoUrl}{!specialInstructionLogoNameMap[flagIconOutputText]}" style="height :50px;"/><br/></apex:outputText>                
                      </apex:pageBlockSection>
                  </div>
            </div>
          </apex:pageBlock>
       </apex:form>
   </apex:outputPanel>
      <apex:outputPanel rendered="{!!templateFlag}" >
          <apex:form >
          <apex:pageBlock title="Special Instructions" >
              <div>
                <center>
                        <apex:actionstatus id="actStatusId2">
                              <apex:facet name="start">
                                  <div class="waitingSearchDiv"
                                       style="background-color: #fbfbfb; height: 100%; opacity: 0.65; width: 100%;position:fixed;z-index:1000;">
                                      <div class="waitingHolder" style="top: 50%; width: 91px; position: fixed;z-index: 1001; left: 50%;">
                                          <img class="waitingImage" src="/img/loading.gif"
                                               title="Please Wait.." /> <span class="waitingDescription">Loading..</span>
                                      </div>
                                  </div>
                              </apex:facet>
                          </apex:actionstatus> 
                      </center>
                  <apex:pageBlockSection columns="1"  id="sec"><apex:pageMessages /></apex:pageBlockSection>
                  <apex:pageBlockSection columns="2" title="New Special Instruction" collapsible="false" id="secondPage">
                      
                      <apex:inputField value="{!specialInstructionsObject.Title__c }" required="true"/>
                      <apex:inputField value="{!specialInstructionsObject.Account__c}" />
                      <apex:inputField value="{!specialInstructionsObject.Start_Date__c}" required="true" />
                      <apex:inputField value="{!specialInstructionsObject.Expiration_Date__c}"/>
                      <apex:inputField value="{!specialInstructionsObject.Instructions__c }" required="true" />
                      <apex:inputField value="{!specialInstructionsObject.Show_for_Record_Types__c }" required="true"  />
                      
                  </apex:pageBlockSection>
                  
                  <apex:pageBlockButtons >
                      <apex:commandButton action="{!createSpecialInstruction}" value="Save" status="actStatusId2" reRender="sec">
                        <apex:param name="isTemplate" value="false"/>
                      </apex:commandButton>
                      <apex:commandButton action="{!cancel}" value="Cancel"/>
          </apex:pageBlockButtons>     </div>  
          </apex:pageBlock>
              </apex:form>
      </apex:outputPanel>
</apex:page>