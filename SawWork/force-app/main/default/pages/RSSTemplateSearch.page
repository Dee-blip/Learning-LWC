<apex:page controller="RSSTemplateSearch" >
<script type="text/javascript" src="/resource/Jquery/js/jquery-1.7.1.min.js"></script>
<script type="text/javascript" src="/resource/Jquery/js/jquery-ui-1.8.17.custom.min.js"/>
  <link rel="stylesheet" type="text/css" href="/resource/Jquery/css/flick/jquery-ui-1.8.17.custom.css"></link>
<script>
toggleSwitch = false;
//Below functions are for showing and hiding the search bar.
  function changebgColormouseover(obj)
  {
      obj.style.backgroundColor="#E9E8E8";
  }
   function changebgColormouseout(obj)
  {
      obj.style.backgroundColor="";
  }
  function toggleSearch()
  {
     //var x = document.getElementsByClassName('HideSearchBarClose');
     //var y = document.getElementsByClassName('HideSearchBarOpen');
     jQuickFilter$ = jQuery.noConflict();
     var x =jQuickFilter$(".HideSearchBarClose");
     var y=jQuickFilter$(".HideSearchBarOpen");
     if(!toggleSwitch)
     {
        for (i=0;i<x.length;i++)
        {
          x[i].style.display="none"; 
        }
        for (i=0;i<y.length;i++)
        {
          y[i].style.display=""; 
        }
          
        
        
     }
     else
     {
       for (i=0;i<y.length;i++)
        {
          y[i].style.display="none"; 
        }
        for (i=0;i<x.length;i++)
        {
          x[i].style.display=""; 
        }
     }
      toggleSwitch=!toggleSwitch;
  }
  </script>
  
 <table width="100%" border="0">
  <tr> 
    
    <td width="200" valign="top" class="HideSearchBarOpen" style="display:none;">
    <apex:outputPanel id="abcd">
    <!-- Search Component -->
     <c:EB_Quick_Filter pageController="{!this}" SearchFieldset="{!searchFields}" Status="FilterLoading"  DefaultSortOrderDirection="Asc" DefaultOrderBy="Name" inputQuery="{!InputQuery}" Title="Search" reRenderid="label" Limit="5000" id="component"  /> 
     
    
    </apex:outputPanel>
    </td>
   <td id="HideSearchBar" onmouseover="changebgColormouseover(this);" onmouseout="changebgColormouseout(this);" onclick="toggleSearch();" valign="top" >   
    <img class="HideSearchBarClose" src="/img/sidebar/LNav_twisty_closed.gif"  />
    <img class="HideSearchBarOpen" src="/img/sidebar/LNav_twisty_opened.gif" style="display:none;"/>
    
    </td>
    <td valign="top" style="width:100%">
 <apex:form >
    
    <apex:pageBlock id="label" title="RSS Template">
         <apex:pageMessages ></apex:pageMessages>
        <table width="100%" cellspacing="5px" >
        <tr>
            <td align="left">
                <table>
                <tr>
                <td>
                 <apex:commandButton value="Create New Template" action="{!goToCreateNewSurveyPage}" style="font-size:120%;background:#F8BB60" rendered="{!WriteAccessOfUser}"/>
                 </td>
                 <td style="vertical-align: middle;"> 
                 Select View :
                 </td>
                 <td style="vertical-align: middle;">                 
                 <apex:selectList label="Views" title="Views" size="1" multiselect="false" value="{!SelectedView}">
                 <apex:selectOption itemValue="Published Templates" itemLabel="Published Templates" itemDescription="Published Templates" ></apex:selectOption>
                 <apex:selectOption itemValue="My Open Templates" itemLabel="My Open Templates" itemDescription="My Open Templates" itemDisabled="{!!WriteAccessOfUser}" ></apex:selectOption>
                 <apex:selectOption itemValue="All" itemLabel="All" itemDescription="All" itemDisabled="{!!WriteAccessOfUser}"></apex:selectOption>
                 <apex:actionSupport event="onchange" action="{!ChangeInputString}" status="FilterLoading" reRender="label"/>
                 </apex:selectList>  
                 </td>
                 </tr>
                 </table>
                <!-- Show my Templates<apex:inputCheckbox value="{!ShowMyTemplates}" title="Show all active Templates" label="Show all active Templates" >
                 <apex:actionSupport event="onclick" id="Sview" action="{!ChangeInputString}" reRender="abcd,label,Sview" status="FilterLoading"/>
                 </apex:inputCheckbox-->
            </td> 
            
            <td align="right">
                  <apex:commandLink status="FilterLoading" action="{!first}" > First </apex:commandlink> &nbsp;&nbsp;&nbsp;&nbsp;
            
                  <apex:commandLink action="{!previous}" rendered="{!hasPrevious}" > Previous </apex:commandlink> &nbsp;&nbsp;&nbsp;&nbsp;
           
                  <apex:commandLink action="{!next}" rendered="{!hasNext}" > Next </apex:commandlink> &nbsp;&nbsp;&nbsp;&nbsp;
           
                  <apex:commandLink action="{!last}" > Last </apex:commandlink> 
            </td>
                      
        </tr>
        </table>
       <center>  </center>
        <apex:actionStatus id="FilterLoading">
        <apex:facet name="start">
        <c:enhancedActionStatus BackColor="#ffffff" borderColor="#ffffff" borderSize="2" height="50px" width="150px" ImageUrl="/changemgmt/img/spinner24.gif" Message="Filter is Being Applied" messageStyle="color:darkred;font-size:11pt;font-weight:bold;"/>
        </apex:facet>   
        </apex:actionStatus>
        
        <apex:pageBlockTable value="{!RSSTemplates}" var="a">
             <apex:column rendered="{!if(SelectedView = 'My Open Templates',true,false) && WriteAccessOfUser}" >
                
            <apex:commandLink value="Delete" onclick="return confirm('Do you want to delete this template?');" action="{!deleteTemplate}">
            <apex:param value="{!a.id}" assignTo="{!DeleteTemplateId}" name="abcd"/>
            </apex:commandLink>
            </apex:column>
            <apex:column >
                <apex:facet name="header">
                
                    <apex:commandLink status="FilterLoading" value="Template Name" action="{!toggleSortOrder}"  rerender="label">
                        <apex:param name="sortField" value="Name" assignTo="{!sortField}"/>
                    </apex:commandLink>
                    
                </apex:facet>
                <a href="/apex/RSSEditTemplate?id={!a.Id}" target="_top"><apex:outputField value="{!a.Name}"/></a>
            </apex:column>
            <apex:column >
                <apex:facet name="header">
                <apex:commandLink status="FilterLoading" value="Template Version" action="{!toggleSortOrder}"  rerender="label">
                        <apex:param name="sortField" value="Version__c" assignTo="{!sortField}"/>
                    </apex:commandLink>
                   
                </apex:facet>
                <apex:outputField value="{!a.Version__c}"/>
            </apex:column>
            <apex:column >
                <apex:facet name="header">
                <apex:commandLink status="FilterLoading" value="Owner" action="{!toggleSortOrder}"  rerender="label">
                        <apex:param name="sortField" value="Owner.Name" assignTo="{!sortField}"/>
                    </apex:commandLink>
                   
                </apex:facet>
                <apex:outputField value="{!a.Owner.Name}"/>
            </apex:column>
            
            <apex:column >
                <apex:facet name="header">
                <apex:commandLink status="FilterLoading" value="Last Modified Date" action="{!toggleSortOrder}"  rerender="label">
                        <apex:param name="sortField" value="LastModifiedDate" assignTo="{!sortField}"/>
                    </apex:commandLink>
                   
                </apex:facet>
                <apex:outputField value="{!a.LastModifiedDate}"/>
            </apex:column>
            
            <apex:column rendered="{!ShowMyTemplates}">
                <apex:facet name="header">
                <apex:commandLink status="FilterLoading" value="Published" action="{!toggleSortOrder}"  rerender="label">
                        <apex:param name="sortField" value="RSS_Published__c" assignTo="{!sortField}"/>
                    </apex:commandLink>
                   
                </apex:facet>
                <apex:outputField value="{!a.RSS_Published__c}"/>
            </apex:column> 
            <!--apex:column >
                <apex:facet name="header">
                    <apex:commandLink status="FilterLoading" value="Incident #" action="{!toggleSortOrder}"  rerender="label">
                        <apex:param name="sortField" value="name" assignTo="{!sortField}"/>
                    </apex:commandLink>
                </apex:facet>
                <apex:outputField value="{!a.SI_Incident_Link__c}"/>
            </apex:column-->               
        </apex:pageBlockTable>

        

     <apex:outputPanel rendered="{!DebugRender}">     {!myComponentController.outputQuery}</apex:outputPanel>
    </apex:pageBlock>
  </apex:form>
    </td>
  </tr>
  </table>
  
  
</apex:page>