<apex:page standardController="Policy_Domain__c" extensions="SC_SOCC_RUNBOOK_Print_PDF" applyHtmlTag="false" showHeader="false" renderAs="pdf" standardStylesheets="false">
     
    <!-- <apex:slds/>-->
    <head>
        <style type="text/css" >
            @page {
            size: letter;
            margin: 10mm;
            @top-left {
            content: element(header);
            }
            @bottom-left{
            content: element(footer);
            margin: -5mm;
            }
            margin-top:60px;
            margin-bottom:42px;
            border: 2px solid black; 
            border-spacing:10px !important;
            }
            th
            { 
            padding: 10px;
            }
            td 
            { 
            padding: 10px;
            padding-left:10rem !important;
            }
            tr
            {
            padding: 10px;
            }
            div.footer
            {
            position: running(footer);
            }
            div.header
            {
            position: running(header);
            }
            
            body { font-family: Arial Unicode MS; }
            font { font-family: Arial Unicode MS !important; }
        </style>
    </head>
    
    <body>
        <div class="header">
            <div style="float:left;">
                <apex:image url="{!$Resource.SC_SOCC_Print_Header}"/>
            </div>
            <div style="float:right;font-size:12px;width:75%;margin-top:5px;">
                {!$Label.JV_Phone}: (+1) 617-444-4955
                <br/>
                {!$Label.JV_Global_Phone}: <a href="https://www.akamai.com/us/en/support/global-support-phone-numbers.jsp" target="_blank">
                https://www.akamai.com/us/en/support/global-support-phone-numbers.jsp</a>
                <br/>
                {!$Label.JV_Email}:   managedsecurity@akamai.com
            </div>
        </div>
        
        <div class="footer">
            <div align="left">
                <apex:image url="{!$Resource.SC_SOCC_Print_Footer}" style="width:335%; margin-left: -10mm;"/>
            </div>
        </div>
        
        <div style="font-family:'Arial Unicode MS'">
            <h3 >
                {!$Label.Jarvis_sC_SOCC_CommunityPDList_TableColumnRunbook}
            </h3>
            <table>
                <tr>
                    <th style="font-family:'Arial Unicode MS';font-weight: 100;font-size: .25rem;">
                        {!$Label.JV_Policy_Domain}
                    </th>
                    
                    <td>
                        <apex:outputField value="{!Policy_Domain__c.name}"/>
                    </td>
                </tr>
                <tr>
                    <th style="font-family:'Arial Unicode MS';font-weight: 100;font-size: .25rem;">
                        {!$Label.JV_Product}
                    </th>
                    
                    <td>
                        <apex:outputField value="{!Policy_Domain__c.Product__c}"/>
                    </td>
                </tr>
                <tr>
                    <th style="font-family:'Arial Unicode MS';font-weight: 100;font-size: .25rem;">
                        {!$Label.JV_Additional_Porducts}
                    </th>
                    
                    <td style="padding-left:10rem !important;">
                        <apex:outputField value="{!Policy_Domain__c.Additional_Product__c}"/>
                    </td>
                </tr>
            </table>
        </div>
        
        <div style="font-family:'Arial Unicode MS'">
            <h3>
                {!$Label.JV_Situation_Handlers}
            </h3>
        </div>
        
        <div >
            <table>
                <apex:repeat value="{!shMapList}" var="shMap">
                    <table>
                        <div style="font-family:'Arial Unicode MS';padding-bottom:1rem;">
                            <apex:outputText value="{!'['+shMap.SHMap.Handler__r.Name+'] for ['+shMap.SituationNameList+']'}"/> 
                        </div>
                        
                        <div style="margin-top:20px;margin-bottom:20px;background-color:#f4f4f4;padding:10px;font-family:'Arial Unicode MS'">
                            <div>
                                <h4>
                                    <apex:outputText value="Handler" style="font-weight:bold"/> 
                                </h4>
                            </div>
                            <tr>
                                <th style="font-family:'Arial Unicode MS';font-weight: bold;font-size: .50rem;">
                                    {!$Label.JV_Handler_Name}
                                </th>
                                
                                <td style="padding-left:1rem !important;">
                                    <apex:outputField value="{!shMap.Handler.Name}"/>
                                </td>
                            </tr>
                            <tr>
                                <th style="font-family:'Arial Unicode MS';font-weight: bold;font-size: .50rem;">
                                    {!$Label.JV_Handler_Type}
                                </th>
                                
                                <td style="padding-left:1rem !important;vertical-align: inherit;">
                                    <apex:outputField value="{!shMap.Handler.Handler_Type__c}"/>
                                </td>
                            </tr>
                            
                            <tr style="display:{!IF(contains(handlerFieldsMap[shMap.Handler.Handler_Type__r.Name],'Situation_Instruction__c'),'','none')}">
                                <th style="font-family:'Arial Unicode MS';font-weight: bold;font-size: .50rem;">
                                    {!$Label.JV_Situation_Instruction}
                                </th>
                                
                                <td style="padding-left:1rem !important;">
                                    <apex:outputField value="{!shMap.Handler.Situation_Instruction__c}"/>
                                </td>
                            </tr>
                            
                            <tr style="display:{!IF(contains(handlerFieldsMap[shMap.Handler.Handler_Type__r.Name],'Ignore_Condition__c'),'','none')}">
                                <th style="font-family:'Arial Unicode MS';font-weight: bold;font-size: .50rem;">
                                    {!$Label.JV_Ignore_Condition}
                                </th>
                                
                                <td style="padding-left:1rem !important;">
                                    <apex:outputField value="{!shMap.Handler.Ignore_Condition__c}"/>
                                </td>
                            </tr>
                            
                            <div>
                                <h4>
                                    {!$Label.JV_Escalation_List} 
                                </h4>
                            </div>
                            <tr>
                                <th style="font-family:'Arial Unicode MS';font-weight: bold;font-size: .50rem;">
                                    {!$Label.JV_Name}
                                </th>
                                
                                <td style="padding-left:1rem !important;">
                                    <apex:outputText value="{!shMap.Handler.Escalation_List__r.Name}"/>
                                </td>
                            </tr>
                            
                            <div style="padding:10px;font-size:12px;">
                                <b>{!shMap.EscConLength} {!$Label.JV_Esclation_Via_Phone}</b>
                            </div>
                            
                            <div >
                                <table style="table-layout: fixed;width:100%;border-collapse: collapse;">
                                    <!--Table Header-->
                                    <thead style="background: rgb(28, 88, 115)!important;font-color:white;">
                                        <tr style="border:1px solid black;">
                                            <th style="width: 8%; text-align: center;color:white;font-size:12px;border:1px solid black;overflow: hidden;">
                                                <div style="word-break: break-word;">{!$Label.JV_Order}</div>
                                            </th>
                                            <th style="width: 12%;color:white;font-size:12px;border:1px solid black;overflow:hidden;">
                                                <div style="word-wrap: break-word;word">{!$Label.JV_Contact_Name}</div>
                                            </th>
                                            <th style="width: 16%;color:white;font-size:12px;border:1px solid black;overflow:hidden;">
                                                <div style="word-break: break-word;">{!$Label.JV_Email_Caps}</div>
                                            </th>
                                            <th style="width: 15%;color:white;font-size:12px;border:1px solid black;overflow:hidden;">
                                                <div style="word-break: break-word;">{!$Label.JV_Primary_Contact}</div>
                                            </th>
                                            <th style="width: 14%;color:white;font-size:12px;border:1px solid black;overflow:hidden;">
                                                <div style="word-break: break-word;">{!$Label.JV_Secondary_Contact}</div>
                                            </th>
                                            <th style="width: 15%;color:white;font-size:12px;border:1px solid black;overflow:hidden;">
                                                <div style="word-break: break-word;">{!$Label.JV_Action_If_Unavailable}</div>
                                            </th>
                                            <th style="width: 20%;color:white;font-size:12px;border:1px solid black;overflow:hidden;">
                                                <div style="word-break: break-word;">{!$Label.JV_Availability}</div>
                                            </th>
                                        </tr>
                                    </thead>
                                    
                                    <tbody>
                                        <apex:repeat value="{!shMap.EscalationContact}" var="escCon">
                                            <tr>
                                                <td style="border:1px solid black;word-wrap: break-word;width:8%;text-align: center;">
                                                    <apex:outputField value="{!escCon.Order_Number__c}"/>
                                                </td>
                                                
                                                <td style="border:1px solid black;word-wrap: break-word;width:12%;">
                                                    <apex:outputField value="{!escCon.Authorized_Contact__r.Contact_Name__r.Name}"/>
                                                </td>
                                                
                                                <td style="border:1px solid black;width:16%;
                                                           overflow-wrap: break-word;
                                                           word-break: break-all;
                                                           overflow: hidden;
                                                           ">
                                                    <apex:outputField style="word-break: break-word;overflow-wrap: break-word;" value="{!escCon.Authorized_Contact__r.Contact_Name__r.Email}"/>
                                                </td>
                                                <td style="border:1px solid black;word-wrap: break-word;width:15%;">
                                                    <apex:outputField rendered="{!escCon.Authorized_Contact__r.Contact_Name__r.Primary_Contact_Method__c='Phone'}" value="{!escCon.Authorized_Contact__r.Contact_Name__r.Phone}"/>
                                                    <apex:outputField rendered="{!escCon.Authorized_Contact__r.Contact_Name__r.Primary_Contact_Method__c='Mobile'}" value="{!escCon.Authorized_Contact__r.Contact_Name__r.MobilePhone}"/>
                                                    
                                                </td>
                                                
                                                <td style="border:1px solid black;word-wrap: break-word;width:14%;">
                                                    <apex:outputField rendered="{!escCon.Authorized_Contact__r.Contact_Name__r.Secondary_Contact_Method__c='Phone'}" value="{!escCon.Authorized_Contact__r.Contact_Name__r.Phone}"/>
                                                    <apex:outputField rendered="{!escCon.Authorized_Contact__r.Contact_Name__r.Secondary_Contact_Method__c='Mobile'}" value="{!escCon.Authorized_Contact__r.Contact_Name__r.MobilePhone}"/>
                                                </td>
                                                
                                                <td style="border:1px solid black;word-wrap: break-word;width:15%;">
                                                    <apex:outputField value="{!escCon.Action_If_Unreachable__c}"/>
                                                </td>
                                                
                                                <td style="border:1px solid black;word-wrap: break-word;width:20%;">
                                                    <!--<apex:repeat value="{!shMap.availabilityMap}" var="escCon2" {!IF(shMap.availabilityMap[escCon] != null, true, false)}>-->
                                                    <!--<apex:repeat value="{!shMap.availabilityMap[escCon]}" var="escConAvail">
                                                        <span >
                                                            <apex:outputText style="font-weight: bold;color:{!IF(escConAvail.Availability__c=='All Day','#34871f',IF(escConAvail.Availability__c=='Specific Time','#EDB00A','rgb(8,7,7);'))}" rendered="{!escConAvail.Day_Of_Week__c = 'Monday'}" value="M"/>
                                                            <apex:outputText style="font-weight: bold;color:{!IF(escConAvail.Availability__c=='All Day','#34871f',IF(escConAvail.Availability__c=='Specific Time','#EDB00A','rgb(8,7,7);'))}" rendered="{!escConAvail.Day_Of_Week__c = 'Tuesday'}" value="T"/>
                                                            <apex:outputText style="font-weight: bold;color:{!IF(escConAvail.Availability__c=='All Day','#34871f',IF(escConAvail.Availability__c=='Specific Time','#EDB00A','rgb(8,7,7);'))}" rendered="{!escConAvail.Day_Of_Week__c = 'Wednesday'}" value="W"/>
                                                            <apex:outputText style="font-weight: bold;color:{!IF(escConAvail.Availability__c=='All Day','#34871f',IF(escConAvail.Availability__c=='Specific Time','#EDB00A','rgb(8,7,7);'))}" rendered="{!escConAvail.Day_Of_Week__c = 'Thursday'}" value="T"/>
                                                            <apex:outputText style="font-weight: bold;color:{!IF(escConAvail.Availability__c=='All Day','#34871f',IF(escConAvail.Availability__c=='Specific Time','#EDB00A','rgb(8,7,7);'))}" rendered="{!escConAvail.Day_Of_Week__c = 'Friday'}" value="F"/>
                                                            <apex:outputText style="font-weight: bold;color:{!IF(escConAvail.Availability__c=='All Day','#34871f',IF(escConAvail.Availability__c=='Specific Time','#EDB00A','rgb(8,7,7);'))}" rendered="{!escConAvail.Day_Of_Week__c = 'Saturday'}" value="S"/>
                                                            <apex:outputText style="font-weight: bold;color:{!IF(escConAvail.Availability__c=='All Day','#34871f',IF(escConAvail.Availability__c=='Specific Time','#EDB00A','rgb(8,7,7);'))}" rendered="{!escConAvail.Day_Of_Week__c = 'Sunday'}" value="S"/>
                                                        </span>
                                                    </apex:repeat>-->
                                                    
                                                    <!--<apex:repeat value="{!shMap.availabilityColorMap[escCon]}" var="escConAvail">-->
                                                        <span >
                                                            <apex:outputText style="font-weight: bold;color:{!SUBSTITUTE(shMap.availabilityColorMap[escCon].Monday,'background-color:','')}" value="M"/>&nbsp;
                                                            <apex:outputText style="font-weight: bold;color:{!SUBSTITUTE(shMap.availabilityColorMap[escCon].Tuesday,'background-color:','')}" value="T"/>&nbsp;
                                                            <apex:outputText style="font-weight: bold;color:{!SUBSTITUTE(shMap.availabilityColorMap[escCon].Wednesday,'background-color:','')}" value="W"/>&nbsp;
                                                            <apex:outputText style="font-weight: bold;color:{!SUBSTITUTE(shMap.availabilityColorMap[escCon].Thursday,'background-color:','')}" value="T"/>&nbsp;
                                                            <apex:outputText style="font-weight: bold;color:{!SUBSTITUTE(shMap.availabilityColorMap[escCon].Friday,'background-color:','')}" value="F"/>&nbsp;
                                                            <apex:outputText style="font-weight: bold;color:{!SUBSTITUTE(shMap.availabilityColorMap[escCon].Saturday,'background-color:','')}" value="S"/>&nbsp;
                                                            <apex:outputText style="font-weight: bold;color:{!SUBSTITUTE(shMap.availabilityColorMap[escCon].Sunday,'background-color:','')}" value="S"/>&nbsp;
                                                        </span>
                                                    <!--</apex:repeat>-->
                                                    <!--</apex:repeat>-->
                                                </td>
                                            </tr>
                                        </apex:repeat>
                                    </tbody>
                                    
                                </table> 
                            </div>
                            
                            
                            <div style="padding:10px;font-size:12px;padding-top:50px;">
                                <b>{!shMap.EscConViaEmailLength} {!$Label.JV_Notify_Case_Email}</b>
                            </div>
                            
                            <div style="table-layout: fit-content;">
                                <table style="border-collapse: collapse;">
                                    
                                    <!--Table Header-->
                                    <thead style="background: rgb(28, 88, 115)!important;font-color:white;">
                                        <tr >
                                            <th style="border:1px solid black;width: 20%; text-align: center;color:white;font-size:12px;overflow: hidden;">
                                                <div style="word-break: break-word;">{!$Label.JV_Contact_Name}</div>
                                            </th>
                                            <th style="border:1px solid black;width: 18%;color:white;font-size:12px;overflow: hidden;">
                                                <div>{!$Label.JV_Email_Caps}</div>
                                            </th>
                                            <th style="border:1px solid black;width: 18%;color:white;font-size:12px;overflow: hidden;">
                                                <div>{!$Label.JV_SMS}</div>
                                            </th>
                                            <th style="border:1px solid black;width: 19%;color:white;font-size:12px;overflow: hidden;">
                                                <div>{!$Label.JV_Account}</div>
                                            </th>
                                            <th style="border:1px solid black;color:white;font-size:12px;overflow: hidden;">
                                                <div>{!$Label.JV_Service_Account}</div>
                                            </th>
                                        </tr>
                                    </thead>
                                    
                                    <tbody>
                                        <apex:repeat value="{!shMap.EscalationContactViaEmail}" var="escCon">
                                            <tr>
                                                <td style="border:1px solid black;word-break: break-word; word-wrap: break-word;">
                                                    <apex:outputField value="{!escCon.Authorized_Contact__r.Contact_Name__r.Name}"/>
                                                </td>
                                                
                                                <td style="border:1px solid black;word-break: break-word; word-wrap: break-word;">
                                                    <apex:outputField value="{!escCon.Authorized_Contact__r.Contact_Name__r.Email}"/>
                                                </td>
                                                
                                                <td style="border:1px solid black;word-break: break-word; word-wrap: break-word;">
                                                    <apex:outputField value="{!escCon.Authorized_Contact__r.Contact_Name__r.SMS_Notifications__c}"/>
                                                </td>
                                                <td style="border:1px solid black;word-break: break-word; word-wrap: break-word;">
                                                    <apex:outputField value="{!escCon.Authorized_Contact__r.Policy_Domain__r.Account_Name__r.Name}"/>
                                                </td>
                                                
                                                <td style="border:1px solid black;word-break: break-word; word-wrap: break-word;">
                                                    <apex:outputField value="{!escCon.Authorized_Contact__r.Policy_Domain__r.Service_Account__r.Name}"/>
                                                </td>
                                                
                                            </tr>
                                        </apex:repeat>
                                    </tbody>
                                    
                                </table> 
                            </div>
                        </div>
                        
                    </table>
                    
                </apex:repeat>
            </table>
        </div>
    </body>
</apex:page>