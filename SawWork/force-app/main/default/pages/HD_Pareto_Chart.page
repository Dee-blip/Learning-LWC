<apex:page showheader="false" id="dashboardPage" sidebar="false" controller="ChartController"  standardStylesheets="true" >
<html lang="en">
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no;" />
    <meta charset="utf-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <meta name="description" content=""/>
    <meta name="author" content=""/>
    <apex:includeScript value="{!URLFOR($Resource.JQuery191, '/jquery-1.9.1.min.js')}"/>
    </head>
    <body>
      <div id="wrapper">
        <apex:form id="dashboardForm" >
          <div id="page-content-wrapper">
            <div class="container-fluid">
              <div class="row">
                <div class="col-lg-12">
                  <apex:actionPoller reRender="chartDisplay, chart1" interval="300" /> 
                  <span>
                    <apex:outputPanel id="chartDisplay" >
                      <apex:panelGrid width="100%" columns="1">
                        <apex:pageBlock title="Tickets Created By Category" id="chartblock1" >
                            <apex:chart resizable="true" animate="true" id="chart1" height="360px"   width="100%" data="{!data}" renderTo="displayChart1" >
                            <apex:axis type="Numeric" position="left" fields="data2"
                            title="Tickets Raised" grid="true" minimum="0" />
                            <apex:axis type="Numeric" position="right" fields="data3"
                            title="Cumulative Percentage" minimum="0" />
                            <apex:axis type="Category" position="bottom" fields="name"
                            title="Category">
                              <apex:chartLabel rotate="270" />
                            </apex:axis>
                            <apex:barSeries orientation="vertical" axis="left"
                              xField="name" yField="data2" />
                            <apex:lineSeries axis="right" xField="name" yField="data3"
                              markerType="circle" markerSize="4" markerFill="#8E35EF" />
                          </apex:chart>
                          <apex:pageMessages />
                          <apex:selectList value="{!category}" multiselect="false" size="1" onchange="{!HTMLENCODE(test)}" >
                            <apex:selectOptions value="{!categories}"/>
                            <apex:actionSupport action="{!test}" event="onchange" reRender="chart1,chartblock1" />
                          </apex:selectList>
                          <apex:selectList value="{!month}" multiselect="false" size="1" onchange="{!HTMLENCODE(test)}" >
                            <apex:selectOptions value="{!months}"/>
                            <apex:actionSupport action="{!test}" event="onchange" reRender="chart1,chartblock1" />
                          </apex:selectList> 
                          <apex:commandButton value="save" action="{!saveMyConfig}"></apex:commandButton>
                          <span id="displayChart1" ></span>
                        </apex:pageBlock> 
                      </apex:panelGrid>
                    </apex:outputPanel>
                  </span>
                </div>
              </div>
            </div>
          </div>
        </apex:form>
      </div>   
    </body>
  </html>
</apex:page>