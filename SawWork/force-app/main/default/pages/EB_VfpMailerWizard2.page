<!--
Author: Jayalakshmi A
Description: Page for displaying the search page for Account/Product search.
Modified on: 11/11/2011 - CR 1403956: Include help text in the search page that informs the users about 24*7 condition.
          2) 06/25/2012 - CR 1733044: Enhancing the existing Account Product Search to Incorporate New Prod Catg Search.
-->
<apex:page controller="EB_CtrlMailerWizard" id="Page1" wizard="false" sidebar="false" tabStyle="create_mailer__tab">
    <apex:form id="form1">

        <P align= "right" >
        <!--<apex:commandLink value="Show Advanced Search Criteria"  action="{!enableButton}" /> |&nbsp; <apex:commandLink value="Hide Advanced Search Criteria"  action="{!disableButton}" />  -->
        </P>
        <apex:pageBlock Title="Accounts, Product Search" id="PBS_Search1">
        <table width="100%"><tr>
         <!--Start of changes: added vertical align:top for CR-1801003 - 21/8/2012 - shifted search block from centre to top By: Shardul -->
            <td width="60%" style="border-color:#E3E4FA;border-width:1px;border-style:none solid none none;vertical-align:top;">
            <!--End of changes: added vertical align:top for CR-1801003 -->  
                <apex:outputText style="font-family: 'arial'; font-size: 12px; font-weight: bold; color:red;" value="(Values entered between rows can use AND/OR logic)"/><br/>
                <apex:pageMessages id="errorMessage">
                </apex:pageMessages>
                   <apex:pageBlockSection title="Specify Search Criteria (field, operator and value) for Account" showHeader="true" collapsible="false" id="section1" columns="1" >
                        <apex:panelGroup >
                            <apex:selectList id="SearchFR1C1" styleclass="std" size="1" value="{!SearchFR1C1}"><apex:selectOptions value="{!PickListItems}"/></apex:selectList>
                            <apex:selectList id="SearchOR1C1" styleclass="std" size="1" value="{!SearchOR1C1}"><apex:selectOptions value="{!Operators}"/></apex:selectList>
                            <apex:inputText id="SearchVR1C1" value="{!SearchVR1C1}" size="17"/> OR 
                            <apex:inputText id="SearchVR1C2" value="{!SearchVR1C2}" size="17"/> OR 
                            <apex:inputText id="SearchVR1C3" value="{!SearchVR1C3}" size="17"/>
                            <apex:selectList id="SearchLR1C3" styleclass="std" size="1" value="{!SearchLR1C3}"><apex:selectOptions value="{!LogicalOperators}"/></apex:selectList>
                       </apex:panelGroup>
                        <apex:panelGroup >

                            <apex:selectList id="SearchFR2C1" styleclass="std" size="1" value="{!SearchFR2C1}"><apex:selectOptions value="{!PickListItems}"/></apex:selectList>
                            <apex:selectList id="SearchOR2C1" styleclass="std" size="1" value="{!SearchOR2C1}"><apex:selectOptions value="{!Operators}"/></apex:selectList>
                            <apex:inputText id="SearchVR2C1" value="{!SearchVR2C1}" size="17"/> OR 
                            <apex:inputText id="SearchVR2C2" value="{!SearchVR2C2}" size="17"/> OR 
                            <apex:inputText id="SearchVR2C3" value="{!SearchVR2C3}" size="17"/>
                            <apex:selectList id="SearchLR2C3" styleclass="std" size="1" value="{!SearchLR2C3}"><apex:selectOptions value="{!LogicalOperators}"/></apex:selectList>
                       </apex:panelGroup>
                        <apex:panelGroup >


                            <apex:selectList id="SearchFR3C1" styleclass="std" size="1" value="{!SearchFR3C1}"><apex:selectOptions value="{!PickListItems}"/></apex:selectList>
                            <apex:selectList id="SearchOR3C1" styleclass="std" size="1" value="{!SearchOR3C1}"><apex:selectOptions value="{!Operators}"/></apex:selectList>
                            <apex:inputText id="SearchVR3C1" value="{!SearchVR3C1}" size="17"/> OR 
                            <apex:inputText id="SearchVR3C2" value="{!SearchVR3C2}" size="17"/> OR 
                            <apex:inputText id="SearchVR3C3" value="{!SearchVR3C3}" size="17"/>
                            <apex:selectList id="SearchLR3C3" styleclass="std" size="1" value="{!SearchLR3C3}"><apex:selectOptions value="{!LogicalOperators}"/></apex:selectList>
                       </apex:panelGroup>
                        <apex:panelGroup >


                            <apex:selectList id="SearchFR4C1" styleclass="std" size="1" value="{!SearchFR4C1}"><apex:selectOptions value="{!PickListItems}"/></apex:selectList>
                            <apex:selectList id="SearchOR4C1" styleclass="std" size="1" value="{!SearchOR4C1}"><apex:selectOptions value="{!Operators}"/></apex:selectList>
                            <apex:inputText id="SearchVR4C1" value="{!SearchVR4C1}" size="17"/> OR 
                            <apex:inputText id="SearchVR4C2" value="{!SearchVR4C2}" size="17"/> OR 
                            <apex:inputText id="SearchVR4C3" value="{!SearchVR4C3}" size="17"/>
                            <apex:selectList id="SearchLR4C3" styleclass="std" size="1" value="{!SearchLR4C3}"><apex:selectOptions value="{!LogicalOperators}"/></apex:selectList>
                       </apex:panelGroup>
                        <apex:panelGroup >


                            <apex:selectList id="SearchFR5C1" styleclass="std" size="1" value="{!SearchFR5C1}"><apex:selectOptions value="{!PickListItems}"/></apex:selectList>
                            <apex:selectList id="SearchOR5C1" styleclass="std" size="1" value="{!SearchOR5C1}"><apex:selectOptions value="{!Operators}"/></apex:selectList>
                            <apex:inputText id="SearchVR5C1" value="{!SearchVR5C1}" size="17"/> OR 
                            <apex:inputText id="SearchVR5C2" value="{!SearchVR5C2}" size="17"/> OR 
                            <apex:inputText id="SearchVR5C3" value="{!SearchVR5C3}" size="17"/>
                            <apex:selectList id="SearchLR5C3" styleclass="std" size="1" value="{!SearchLR5C3}"><apex:selectOptions value="{!LogicalOperators}"/></apex:selectList>
                       </apex:panelGroup>
                        <br/>
                       <!-- added below line of code for CR-785460 - 9/3/2010 - grouped the buttons together and rendering them only if VisibleOption=TRUE -->
                        <apex:pageBlockSection id="Edit_Buttons" rendered="{!VisibleOption}">
                        <apex:panelGroup >
                            <!--<apex:commandButton value="Form Search Criteria" onClick="alertTest()" action="{!getWhereClauseAccount}"/>-->
                           <!-- <apex:commandButton value="Build Account Search" action="{!formSQLWhere}" reRender="PBS_Search1" />
                            <apex:commandButton value="Validate Search" action="{!validateAccount}" />
                            &nbsp;&nbsp;&nbsp;&nbsp;
                            <apex:commandButton value="Edit Account Search" action="{!enable}" reRender="queryStringAccount" />
                            &nbsp;&nbsp;&nbsp;&nbsp;
                            <apex:commandButton value="Clear Account Search" action="{!clearSearch}" reRender="queryStringAccount"/>
                       </apex:panelGroup>
                       <br/>
                        <apex:panelGroup id="queryStringAccount">
                            <!--<apex:inputText id="queryString" value="{!SQLWhere}" style="width: 730px; height: 20px" style="font-family: 'courier new'; width: 730px;  height: 22px; font-size: 12px;"/>-->
                            <apex:inputTextarea id="queryString" value="{!SQLWhere}" rows="2" style="font-family: 'courier new'; font-size: 12px" cols="114" disabled="{!disableStatus}"/>
                            
                       </apex:panelGroup>
                       </apex:pageBlockSection>
                   </apex:pageBlockSection>
                  
                    <apex:pageBlockSection title="Specify Search Criteria (field, operator and value) for Product" showHeader="true"  collapsible="true" id="section2" columns="1" rendered="{!renderOldProductSearch}">
                    <apex:commandLink value="[Products List]" action="{!getAccountProductPage}" target="_blank" style="font-family: arial;  font-size: 12px; font-weight: bold; color: blue;" />
                        <apex:panelGroup >
                            <apex:selectList id="PSearchFR1C1" styleclass="std" size="1" value="{!PSearchFR1C1}"><apex:selectOptions value="{!PickListItemsProduct}"/></apex:selectList>
                            <apex:selectList id="PSearchOR1C1" styleclass="std" size="1" value="{!PSearchOR1C1}"><apex:selectOptions value="{!Operators}"/></apex:selectList>
                            <apex:inputText id="PSearchVR1C1" value="{!PSearchVR1C1}" size="17"/>
                            <apex:inputText id="PSearchVR1C2" value="{!PSearchVR1C2}" size="17"/>
                            <apex:inputText id="PSearchVR1C3" value="{!PSearchVR1C3}" size="17"/>
                            <apex:selectList id="PSearchLR1C3" styleclass="std" size="1" value="{!PSearchLR1C3}"><apex:selectOptions value="{!LogicalOperators}"/></apex:selectList>
                       </apex:panelGroup>
                        <apex:panelGroup >

                            <apex:selectList id="PSearchFR2C1" styleclass="std" size="1" value="{!PSearchFR2C1}"><apex:selectOptions value="{!PickListItemsProduct}"/></apex:selectList>
                            <apex:selectList id="PSearchOR2C1" styleclass="std" size="1" value="{!PSearchOR2C1}"><apex:selectOptions value="{!Operators}"/></apex:selectList>
                            <apex:inputText id="PSearchVR2C1" value="{!PSearchVR2C1}" size="17"/>
                            <apex:inputText id="PSearchVR2C2" value="{!PSearchVR2C2}" size="17"/>
                            <apex:inputText id="PSearchVR2C3" value="{!PSearchVR2C3}" size="17"/>
                            <apex:selectList id="PSearchLR2C3" styleclass="std" size="1" value="{!PSearchLR2C3}"><apex:selectOptions value="{!LogicalOperators}"/></apex:selectList>

                       </apex:panelGroup>
                        <apex:panelGroup >

                            <apex:selectList id="PSearchFR3C1" styleclass="std" size="1" value="{!PSearchFR3C1}"><apex:selectOptions value="{!PickListItemsProduct}"/></apex:selectList>
                            <apex:selectList id="PSearchOR3C1" styleclass="std" size="1" value="{!PSearchOR3C1}"><apex:selectOptions value="{!Operators}"/></apex:selectList>
                            <apex:inputText id="PSearchVR3C1" value="{!PSearchVR3C1}" size="17"/>
                            <apex:inputText id="PSearchVR3C2" value="{!PSearchVR3C2}" size="17"/>
                            <apex:inputText id="PSearchVR3C3" value="{!PSearchVR3C3}" size="17"/>
                            <apex:selectList id="PSearchLR3C3" styleclass="std" size="1" value="{!PSearchLR3C3}"><apex:selectOptions value="{!LogicalOperators}"/></apex:selectList>

                       </apex:panelGroup> 
                       </apex:pageBlockSection>
        
        
         
               <!--    <apex:pageBlockSection id="Edit_Buttons_Set2" rendered="{!VisibleOption}">
                        <apex:panelGroup >
                            &nbsp;&nbsp;&nbsp;&nbsp;
                            <apex:commandButton value="Edit Product Search" action="{!enableProduct}" reRender="searchCriteria"/>
                            &nbsp;&nbsp;&nbsp;&nbsp;
                            <apex:commandButton value="Clear Product Search" action="{!clearProductSearch}" reRender="searchCriteria"/>
                       </apex:panelGroup>
                       <br/>
                        <apex:panelGroup id="searchCriteria">
                            
                            <apex:inputTextarea id="queryString" value="{!PSQLWhere}" rows="2" style="font-family: 'courier new'; font-size: 12px;" cols="114" disabled="{!disableProduct}"/>
                       </apex:panelGroup>
                       </apex:pageBlockSection> 
                       <br />
                       <br />
                        
                   </apex:pageBlockSection> -->
                   
                   <apex:pageBlockSection id="Edit_Buttons_Set2" rendered="{!VisibleOption}">
                        <apex:panelGroup >
                            &nbsp;&nbsp;&nbsp;&nbsp;
                            <apex:commandButton value="Edit Product Search" action="{!enableProduct}" reRender="searchCriteria"/>
                            &nbsp;&nbsp;&nbsp;&nbsp;
                            <apex:commandButton value="Clear Product Search" action="{!clearProductSearch}" reRender="searchCriteria"/>
                       </apex:panelGroup>
                       <br/>
                        <apex:panelGroup id="searchCriteria">
                            
                            <apex:inputTextarea id="queryString" value="{!PSQLWhere}" rows="2" style="font-family: 'courier new'; font-size: 12px;" cols="114" disabled="{!disableProduct}"/>
                       </apex:panelGroup>
                       
                       <br />
                       <br />                     
                   </apex:pageBlockSection>
                   
                   <apex:pageBlockSection >
                       <apex:panelGroup id="dispAccountSQL" >
                            <apex:outputText id="Accountquery" value="{!debugAccountSQL}"  style="font-family: 'courier new'; font-size: 12px;"  />
                       </apex:panelGroup>
                       <apex:panelGroup id="dispProductSQL" >
                            <apex:outputText id="Productquery" value="{!debugProductSQL}"  style="font-family: 'courier new'; font-size: 12px;"  />
                      </apex:panelGroup>
                       <apex:panelGroup id="dispProductSQLtemp" >
                            <apex:outputText id="Productquerytemp" value="{!debugFinalSQL}"  style="font-family: 'courier new'; font-size: 12px;"  />
                       </apex:panelGroup> 
                   </apex:pageBlockSection>
                   <hr width="100%" size="3" color="gray" align="left" /> 
                   <!--<apex:pageBlockButtons location="bottom">-->
                   <p align="left">
                   <apex:commandButton Value="Previous" action="{!main_page}" style="font-size:125%;font-weight:bold;"/> 
                   &nbsp;&nbsp;&nbsp;&nbsp;
                   <apex:commandButton value="Build Search" action="{!formSQLWhere}" reRender="PBS_Search1" rendered="{!VisibleOption}" style="font-size:125%;font-weight:bold;"/>
                   &nbsp;&nbsp;&nbsp;&nbsp;
                   <apex:commandButton value="Validate Search" action="{!validateAccount}" rendered="{!VisibleOption}" style="font-size:125%;font-weight:bold;"/>
                   &nbsp;&nbsp;&nbsp;&nbsp;
                   <apex:commandButton Value="Next" action="{!page2}" style="font-size:125%;font-weight:bold;"/>
                   </p>
                   <!--</apex:pageBlockButtons>-->
            </td>
            <!-- Start of changes for CR 1733044: Enhancing the existing Account Product Search to Incorporate New Prod Catg Search. -->
            <td width="30%;height:100%" style="border-color:#E3E4FA;border-width:1px;border-style:none solid none none;">
            
                <apex:pageBlock rendered="{!renderNewProductSearch}" >
                
                <apex:pageBlockSection title="Specify Search Criteria (field, operator and value) for Product" showHeader="true"  collapsible="true" id="section2" columns="1"  >
        <apex:tabPanel switchType="client" selectedTab="prdDetails">
      <apex:tab label="Product Catalog" name="PrdDetails" id="prdDetails">
        
      
        <apex:outputPanel layout="block" style="overflow:auto; height:500px;margin: 0 2px" >       
            <apex:pageBlockTable value="{!products}" var="p" cellpadding="0" border="1" id="table" style="width:100%;height:100%">
            
                <apex:column width="250px">
                            <apex:facet name="header">                      
                                <apex:commandLink value="Product Name" >
                                </apex:commandLink>
                            </apex:facet>                    
                                         
                            <apex:repeat value="{!wrappers}" var="Products1"  first="0">  
                           
                                <apex:outputText rendered="{!Products1.isModule}">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</apex:outputText>    
                                <apex:outputText rendered="{!Products1.isSubModule}">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</apex:outputText>                                                                                                                                                     
                                <apex:inputCheckbox value="{!Products1.selected}">
                                </apex:inputCheckbox>
                                <apex:outputText value="{!Products1.product.Product_Name__c}"  />                           
                                <br/> 
                                                      
                            </apex:repeat>                                                                                  
                        </apex:column>            
            </apex:pageBlockTable>
        </apex:outputPanel>
        </apex:tab>
        <apex:tab label="Legacy Product" name="LegacyPrdDetails" id="LegacyPrdDetails" styleClass="std" >
        <apex:outputPanel layout="block" style="overflow:auto; height:500px;margin: 0 2px" >
        
        <apex:pageBlockTable value="{!legacyProductList}" var="p" cellpadding="0" border="1" style="width:100%;height:100%">
        <apex:column width="250px">
            <apex:facet name="header">                      
                <apex:commandLink value="Legacy Product Name" >
                </apex:commandLink>
            </apex:facet>                                                                                                                                                                                                                          
                <apex:inputCheckbox value="{!p.selected}">
                </apex:inputCheckbox>
                <apex:outputText value="{!p.product.Product_Name__c}"  />                           
                <br/>          
         </apex:column>
         </apex:pageBlockTable>
        </apex:outputPanel>
        </apex:tab>
        </apex:tabPanel>
        </apex:pageBlockSection>
        </apex:pageBlock> 
        </td>
        <!-- End of changes for CR 1733044: Enhancing the existing Account Product Search to Incorporate New Prod Catg Search. -->
            <!--<td width="25%" style="background-color:#F5F5F5;">
                <p aligh="left" style="font-size:115%; font-style:italic; font-weight:bold;">
                    Why is that a few customers are not listed in the Account Selection interface, even though they meet the search criteria? 
                </p>
                <p align="left" style="font-size:115%;font-weight:normal;">
                    Please note only customers who have 24x7 contacts are listed, so even though a customer meets the criteria, if they do not have 24x7 contacts then they would be exlcuded.
                </p>
                <p aligh="left" style="font-size:115%; font-style:italic; font-weight:bold;">
                    Why am I seeing customers in the Account Selection interface, which do not meet the search criteria? 
                </p>
                <p align="left" style="font-size:115%;font-weight:normal;">
                    Currently all values entered within the same row use OR-logic and values entered vertically in separate rows result in an AND-logic. Hence please revisit the criteria, this could be one of the reasons why a Customer is being listed.
                </p>
            </td> -->
        </tr></table>
       </apex:pageBlock>
   </apex:form> 
</apex:page>