function EB_jsPreview(RecordIds, ContactId, TemplateId)
{
	var Ids = new Array();
	Ids  = RecordIds;
	//alert(Ids);
	var previewURLs = new Array();
	var strPreviewURL;
	var errors = '';
	var message = new Array();
	var count = 0;
	var strPreviewURL1;
	
	if(!Array.indexOf){
  Array.prototype.indexOf = function(obj){
   for(var i=0; i<this.length; i++){
    if(this[i]==obj){
     return i;
    }
   }
   return -1;
  }
}
	previewURLs=sforce.apex.execute("EB_UtilMailer", "getPreviewURL", 
	{ 
	contactId:ContactId, 
	template_Id:TemplateId, 
	akamContactIds:Ids
	} 
	); 
	//var exceptionMessage = new String(previewURLs);
	//if(exceptionMessage.indexOf("-1") == "-1")
	//{
			   //alert(previewURLs); 
			   //strPreviewURL = previewURLs.toString();
			   //strPreviewURL = strPreviewURL.replace(/,/g,'**');
			   //alert(strPreviewURL);
			   //previewURLs = strPreviewURL.split('**');
			   //alert(previewURLs);
			   var i=0;
			   for(i=0;i<previewURLs.length;i++)
			   {
					   if(previewURLs[i].indexOf("-1") == "-1")
							window.open(previewURLs[i]);
					   else
					   {
							//alert(previewURLs[i].substring(2));
							if(count == 0)
							{
								message[i] = 'The Email Template for the Contacts ' +previewURLs[i].substring(2);
								strPreviewURL = message[i].toString();
								var reg = new RegExp(",","g");
								strPreviewURL = strPreviewURL.replace(reg,"[]");
								//strPreviewURL = strPreviewURL.replace(/[,]/g,"");
								//strPreviewURL = strPreviewURL.replace(new RegExp(",","g"),"");
								//message[i] = message[i].replace(/,/g,'');
								count++;
							}
							else
							{
								//message[i] = message[i].replace(/,/g,'');
								//message[i] = ','+previewURLs[i].substring(2);
								message[i] = strPreviewURL+', '+previewURLs[i].substring(2);
								strPreviewURL = message[i].toString();
								//strPreviewURL = strPreviewURL.replace(/,/g,'');
							}
					   }
			   }
			   
			   if(message.length>0)
			   {
					i++;
					//message[i] = ' has been deleted';
					strPreviewURL = strPreviewURL + ' has been deleted';
					//errors = new String(message);
					//errors = errors.replace(/,/g,' ');
					//alert(errors);
					alert(strPreviewURL);
			   }
	//}
	//else
	//{
				//alert(exceptionMessage.substring(2));
	//}
}

function EB_jsSensMailToContact(TargetObjectId, TemplateId, WhatId)
{
	var strResult = sforce.apex.execute("EB_UtilEmailNotification", "sendMailToContact", 
	{ 
	targetObjectId:TargetObjectId,
	template:TemplateId,
	whatId:WhatId
	} 
	); 
	if(strResult == '')
		  alert('Email notification sent to the contact'); 
	else
		   alert(strResult);
	window.location.reload(true);
}


